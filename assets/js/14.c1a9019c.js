(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{738:function(a,t,s){a.exports=s.p+"assets/img/Untitled.fbd4c55d.png"},739:function(a,t,s){a.exports=s.p+"assets/img/Untitled1.95ba29c6.png"},740:function(a,t,s){a.exports=s.p+"assets/img/Untitled2.7eed4646.png"},741:function(a,t,s){a.exports=s.p+"assets/img/Untitled3.26e4385f.png"},742:function(a,t,s){a.exports=s.p+"assets/img/Untitled4.9044bb1b.png"},743:function(a,t,s){a.exports=s.p+"assets/img/Untitled5.5a45265f.png"},744:function(a,t,s){a.exports=s.p+"assets/img/Untitled6.fb6a6845.png"},834:function(a,t,s){"use strict";s.r(t);var n=s(24),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"é«˜å¹¶å‘-ç†è®ºåŸºç¡€"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é«˜å¹¶å‘-ç†è®ºåŸºç¡€"}},[a._v("#")]),a._v(" é«˜å¹¶å‘-ç†è®ºåŸºç¡€")]),a._v(" "),n("h2",{attrs:{id:"å¸¦ç€batå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¸¦ç€batå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£"}},[a._v("#")]),a._v(" å¸¦ç€BATå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£")]),a._v(" "),n("aside",[a._v("\nğŸ’¡ è¯·å¸¦ç€è¿™äº›é—®é¢˜ç»§ç»­åæ–‡ï¼Œä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå¸®åŠ©ä½ æ›´å¥½çš„ç†è§£å¹¶å‘ç†è®ºåŸºç¡€ã€‚\n")]),a._v(" "),n("ul",[n("li",[a._v("å¤šçº¿ç¨‹çš„å‡ºç°æ˜¯è¦è§£å†³ä»€ä¹ˆé—®é¢˜çš„?")]),a._v(" "),n("li",[a._v("çº¿ç¨‹ä¸å®‰å…¨æ˜¯æŒ‡ä»€ä¹ˆ? ä¸¾ä¾‹è¯´æ˜")]),a._v(" "),n("li",[a._v("å¹¶å‘å‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æœ¬è´¨ä»€ä¹ˆ? å¯è§æ€§ï¼ŒåŸå­æ€§å’Œæœ‰åºæ€§ã€‚")]),a._v(" "),n("li",[a._v("Javaæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„? 3ä¸ªå…³é”®å­—ï¼ŒJMMå’Œ8ä¸ªHappens-Before")]),a._v(" "),n("li",[a._v("çº¿ç¨‹å®‰å…¨æ˜¯ä¸æ˜¯éçœŸå³å‡? ä¸æ˜¯")]),a._v(" "),n("li",[a._v("çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯?")]),a._v(" "),n("li",[a._v("å¦‚ä½•ç†è§£å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«?")])]),a._v(" "),n("h2",{attrs:{id:"ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹"}},[a._v("#")]),a._v(" ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹")]),a._v(" "),n("p",[a._v("ä¼—æ‰€å‘¨çŸ¥ï¼ŒCPUã€å†…å­˜ã€I/O è®¾å¤‡çš„é€Ÿåº¦æ˜¯æœ‰æå¤§å·®å¼‚çš„ï¼Œä¸ºäº†åˆç†åˆ©ç”¨ CPU çš„é«˜æ€§èƒ½ï¼Œå¹³è¡¡è¿™ä¸‰è€…çš„é€Ÿåº¦å·®å¼‚ï¼Œè®¡ç®—æœºä½“ç³»ç»“æ„ã€æ“ä½œç³»ç»Ÿã€ç¼–è¯‘ç¨‹åºéƒ½åšå‡ºäº†è´¡çŒ®ï¼Œä¸»è¦ä½“ç°ä¸º:")]),a._v(" "),n("ul",[n("li",[a._v("CPU å¢åŠ äº†ç¼“å­˜ï¼Œä»¥å‡è¡¡ä¸å†…å­˜çš„é€Ÿåº¦å·®å¼‚ï¼›// å¯¼è‡´ "),n("code",[a._v("å¯è§æ€§")]),a._v("é—®é¢˜")]),a._v(" "),n("li",[a._v("æ“ä½œç³»ç»Ÿå¢åŠ äº†è¿›ç¨‹ã€çº¿ç¨‹ï¼Œä»¥åˆ†æ—¶å¤ç”¨ CPUï¼Œè¿›è€Œå‡è¡¡ CPU ä¸ I/O è®¾å¤‡çš„é€Ÿåº¦å·®å¼‚ï¼›// å¯¼è‡´ "),n("code",[a._v("åŸå­æ€§")]),a._v("é—®é¢˜")]),a._v(" "),n("li",[a._v("ç¼–è¯‘ç¨‹åºä¼˜åŒ–æŒ‡ä»¤æ‰§è¡Œæ¬¡åºï¼Œä½¿å¾—ç¼“å­˜èƒ½å¤Ÿå¾—åˆ°æ›´åŠ åˆç†åœ°åˆ©ç”¨ã€‚// å¯¼è‡´ "),n("code",[a._v("æœ‰åºæ€§")]),a._v("é—®é¢˜")])]),a._v(" "),n("aside",[a._v("\nğŸ’¡ å¯è§æ€§é—®é¢˜ï¼šä¸€ä¸ªå…±äº«å˜**é‡**,Açº¿ç¨‹ä¿®æ”¹äº†,Bçº¿ç¨‹éšåè¯»å–åˆ°çš„è¿˜æ˜¯æ—§å€¼,è¿™å°±æ˜¯å¯è§ æ€§é—®é¢˜ .å¯è§ æ€§é—®é¢˜ å¯¼è‡´çº¿ç¨‹è¯»å–åˆ°è„æ•°æ®,æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦ é—®é¢˜ .åæœå¯ä»¥å¾ˆä¸¥é‡\nåŸå­æ€§é—®é¢˜ï¼šåŸå­æ€§æ˜¯æŒ‡**ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸è¢«ä»»ä½•å› ç´ æ‰“æ–­ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚** åœ¨Javaä¸­å½“æˆ‘ä»¬è®¨è®ºä¸€ä¸ªæ“ä½œå…·æœ‰**åŸå­æ€§é—®é¢˜**æ˜¯ä¸€èˆ¬å°±æ˜¯æŒ‡**è¿™ä¸ªæ“ä½œä¼šè¢«çº¿ç¨‹çš„éšæœºè°ƒåº¦æ‰“æ–­**ã€‚\næœ‰åºæ€§é—®é¢˜ï¼šå› ä¸ºç¼–è¯‘å™¨ä¼˜åŒ–ä½¿ç¨‹åºçš„æ‰§è¡Œé¡ºåºå‘ç”Ÿå˜åŒ–å¯¼è‡´ç¨‹åºå‘ç”Ÿå¼‚å¸¸ç»“æœã€‚\n")]),a._v(" "),n("h2",{attrs:{id:"çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹"}},[a._v("#")]),a._v(" çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹")]),a._v(" "),n("p",[a._v("å¦‚æœå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®è€Œä¸é‡‡å–åŒæ­¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆæ“ä½œçš„ç»“æœæ˜¯ä¸ä¸€è‡´çš„ã€‚")]),a._v(" "),n("p",[a._v("ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº† 1000 ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt æ‰§è¡Œè‡ªå¢æ“ä½œï¼Œæ“ä½œç»“æŸä¹‹åå®ƒçš„å€¼æœ‰å¯èƒ½å°äº 1000ã€‚")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ThreadUnsafeExample")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" cnt "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        cnt"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" cnt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br")])]),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("InterruptedException")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" threadSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ThreadUnsafeExample")]),a._v(" example "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ThreadUnsafeExample")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CountDownLatch")]),a._v(" countDownLatch "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("threadSize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ExecutorService")]),a._v(" executorService "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Executors")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("newCachedThreadPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" threadSize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        executorService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("execute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            countDownLatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("countDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    countDownLatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    executorService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("shutdown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("997 // ç»“æœæ€»æ˜¯å°äº1000\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("h2",{attrs:{id:"å¹¶å‘å‡ºç°é—®é¢˜çš„æ ¹æº-å¹¶å‘ä¸‰è¦ç´ "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¹¶å‘å‡ºç°é—®é¢˜çš„æ ¹æº-å¹¶å‘ä¸‰è¦ç´ "}},[a._v("#")]),a._v(" å¹¶å‘å‡ºç°é—®é¢˜çš„æ ¹æº: å¹¶å‘ä¸‰è¦ç´ ")]),a._v(" "),n("p",[a._v("ä¸Šè¿°ä»£ç è¾“å‡ºä¸ºä»€ä¹ˆä¸æ˜¯1000? å¹¶å‘å‡ºç°é—®é¢˜çš„æ ¹æºæ˜¯ä»€ä¹ˆ?")]),a._v(" "),n("h3",{attrs:{id:"å¯è§æ€§-cpuç¼“å­˜å¼•èµ·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¯è§æ€§-cpuç¼“å­˜å¼•èµ·"}},[a._v("#")]),a._v(" å¯è§æ€§: CPUç¼“å­˜å¼•èµ·")]),a._v(" "),n("p",[a._v("å¯è§æ€§ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ã€‚")]),a._v(" "),n("p",[a._v("ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("//çº¿ç¨‹1æ‰§è¡Œçš„ä»£ç \nint i = 0;\ni = 10;\n\n//çº¿ç¨‹2æ‰§è¡Œçš„ä»£ç \nj = i;\n\n        @pdai: ä»£ç å·²ç»å¤åˆ¶åˆ°å‰ªè´´æ¿\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br")])]),n("p",[a._v("å‡è‹¥æ‰§è¡Œçº¿ç¨‹1çš„æ˜¯CPU1ï¼Œæ‰§è¡Œçº¿ç¨‹2çš„æ˜¯CPU2ã€‚ç”±ä¸Šé¢çš„åˆ†æå¯çŸ¥ï¼Œå½“çº¿ç¨‹1æ‰§è¡Œ i =10è¿™å¥æ—¶ï¼Œä¼šå…ˆæŠŠiçš„åˆå§‹å€¼åŠ è½½åˆ°CPU1çš„é«˜é€Ÿç¼“å­˜ä¸­ï¼Œç„¶åèµ‹å€¼ä¸º10ï¼Œé‚£ä¹ˆåœ¨CPU1çš„é«˜é€Ÿç¼“å­˜å½“ä¸­içš„å€¼å˜ä¸º10äº†ï¼Œå´æ²¡æœ‰ç«‹å³å†™å…¥åˆ°ä¸»å­˜å½“ä¸­ã€‚")]),a._v(" "),n("p",[a._v("æ­¤æ—¶çº¿ç¨‹2æ‰§è¡Œ j = iï¼Œå®ƒä¼šå…ˆå»ä¸»å­˜è¯»å–içš„å€¼å¹¶åŠ è½½åˆ°CPU2çš„ç¼“å­˜å½“ä¸­ï¼Œæ³¨æ„æ­¤æ—¶å†…å­˜å½“ä¸­içš„å€¼è¿˜æ˜¯0ï¼Œé‚£ä¹ˆå°±ä¼šä½¿å¾—jçš„å€¼ä¸º0ï¼Œè€Œä¸æ˜¯10.")]),a._v(" "),n("p",[a._v("è¿™å°±æ˜¯å¯è§æ€§é—®é¢˜ï¼Œçº¿ç¨‹1å¯¹å˜é‡iä¿®æ”¹äº†ä¹‹åï¼Œçº¿ç¨‹2æ²¡æœ‰ç«‹å³çœ‹åˆ°çº¿ç¨‹1ä¿®æ”¹çš„å€¼ã€‚")]),a._v(" "),n("h3",{attrs:{id:"åŸå­æ€§-åˆ†æ—¶å¤ç”¨å¼•èµ·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŸå­æ€§-åˆ†æ—¶å¤ç”¨å¼•èµ·"}},[a._v("#")]),a._v(" åŸå­æ€§: åˆ†æ—¶å¤ç”¨å¼•èµ·")]),a._v(" "),n("p",[a._v("åŸå­æ€§ï¼šå³ä¸€ä¸ªæ“ä½œæˆ–è€…å¤šä¸ªæ“ä½œ è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¹¶ä¸”æ‰§è¡Œçš„è¿‡ç¨‹ä¸ä¼šè¢«ä»»ä½•å› ç´ æ‰“æ–­ï¼Œè¦ä¹ˆå°±éƒ½ä¸æ‰§è¡Œã€‚")]),a._v(" "),n("p",[a._v("ç»å…¸çš„"),n("strong",[a._v("è½¬è´¦é—®é¢˜")]),a._v("ï¼šæ¯”å¦‚ä»è´¦æˆ·Aå‘è´¦æˆ·Bè½¬1000å…ƒï¼Œé‚£ä¹ˆå¿…ç„¶åŒ…æ‹¬2ä¸ªæ“ä½œï¼šä»è´¦æˆ·Aå‡å»1000å…ƒï¼Œå¾€è´¦æˆ·BåŠ ä¸Š1000å…ƒã€‚")]),a._v(" "),n("p",[a._v("è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœè¿™2ä¸ªæ“ä½œä¸å…·å¤‡åŸå­æ€§ï¼Œä¼šé€ æˆä»€ä¹ˆæ ·çš„åæœã€‚å‡å¦‚ä»è´¦æˆ·Aå‡å»1000å…ƒä¹‹åï¼Œæ“ä½œçªç„¶ä¸­æ­¢ã€‚ç„¶ååˆä»Bå–å‡ºäº†500å…ƒï¼Œå–å‡º500å…ƒä¹‹åï¼Œå†æ‰§è¡Œ å¾€è´¦æˆ·BåŠ ä¸Š1000å…ƒ çš„æ“ä½œã€‚è¿™æ ·å°±ä¼šå¯¼è‡´è´¦æˆ·Aè™½ç„¶å‡å»äº†1000å…ƒï¼Œä½†æ˜¯è´¦æˆ·Bæ²¡æœ‰æ”¶åˆ°è¿™ä¸ªè½¬è¿‡æ¥çš„1000å…ƒã€‚")]),a._v(" "),n("p",[a._v("æ‰€ä»¥è¿™2ä¸ªæ“ä½œå¿…é¡»è¦å…·å¤‡åŸå­æ€§æ‰èƒ½ä¿è¯ä¸å‡ºç°ä¸€äº›æ„å¤–çš„é—®é¢˜ã€‚")]),a._v(" "),n("h3",{attrs:{id:"æœ‰åºæ€§-é‡æ’åºå¼•èµ·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æœ‰åºæ€§-é‡æ’åºå¼•èµ·"}},[a._v("#")]),a._v(" æœ‰åºæ€§: é‡æ’åºå¼•èµ·")]),a._v(" "),n("p",[a._v("æœ‰åºæ€§ï¼šå³ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("boolean")]),a._v(" flag "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\ni "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("                "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//è¯­å¥1")]),a._v("\nflag "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("          "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//è¯­å¥2")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªintå‹å˜é‡ï¼Œå®šä¹‰äº†ä¸€ä¸ªbooleanç±»å‹å˜é‡ï¼Œç„¶ååˆ†åˆ«å¯¹ä¸¤ä¸ªå˜é‡è¿›è¡Œèµ‹å€¼æ“ä½œã€‚ä»ä»£ç é¡ºåºä¸Šçœ‹ï¼Œè¯­å¥1æ˜¯åœ¨è¯­å¥2å‰é¢çš„ï¼Œé‚£ä¹ˆJVMåœ¨çœŸæ­£æ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶å€™ä¼šä¿è¯è¯­å¥1ä¸€å®šä¼šåœ¨è¯­å¥2å‰é¢æ‰§è¡Œå—? ä¸ä¸€å®šï¼Œä¸ºä»€ä¹ˆå‘¢? è¿™é‡Œå¯èƒ½ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’åºï¼ˆInstruction Reorderï¼‰ã€‚")]),a._v(" "),n("p",[a._v("åœ¨æ‰§è¡Œç¨‹åºæ—¶ä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤åšé‡æ’åºã€‚é‡æ’åºåˆ†ä¸‰ç§ç±»å‹ï¼š")]),a._v(" "),n("ul",[n("li",[a._v("ç¼–è¯‘å™¨ä¼˜åŒ–çš„é‡æ’åºã€‚ç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œå¯ä»¥é‡æ–°å®‰æ’è¯­å¥çš„æ‰§è¡Œé¡ºåºã€‚")]),a._v(" "),n("li",[a._v("æŒ‡ä»¤çº§å¹¶è¡Œçš„é‡æ’åºã€‚ç°ä»£å¤„ç†å™¨é‡‡ç”¨äº†æŒ‡ä»¤çº§å¹¶è¡ŒæŠ€æœ¯ï¼ˆInstruction-Level Parallelismï¼Œ ILPï¼‰æ¥å°†å¤šæ¡æŒ‡ä»¤é‡å æ‰§è¡Œã€‚å¦‚æœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œå¤„ç†å™¨å¯ä»¥æ”¹å˜è¯­å¥å¯¹åº”æœºå™¨æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚")]),a._v(" "),n("li",[a._v("å†…å­˜ç³»ç»Ÿçš„é‡æ’åºã€‚ç”±äºå¤„ç†å™¨ä½¿ç”¨ç¼“å­˜å’Œè¯» / å†™ç¼“å†²åŒºï¼Œè¿™ä½¿å¾—åŠ è½½å’Œå­˜å‚¨æ“ä½œçœ‹ä¸Šå»å¯èƒ½æ˜¯åœ¨ä¹±åºæ‰§è¡Œã€‚")])]),a._v(" "),n("p",[a._v("ä» java æºä»£ç åˆ°æœ€ç»ˆå®é™…æ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ï¼Œä¼šåˆ†åˆ«ç»å†ä¸‹é¢ä¸‰ç§é‡æ’åºï¼š")]),a._v(" "),n("p",[n("img",{attrs:{src:s(738),alt:"Untitled"}})]),a._v(" "),n("p",[a._v("ä¸Šè¿°çš„ 1 å±äºç¼–è¯‘å™¨é‡æ’åºï¼Œ2 å’Œ 3 å±äºå¤„ç†å™¨é‡æ’åºã€‚è¿™äº›é‡æ’åºéƒ½å¯èƒ½ä¼šå¯¼è‡´å¤šçº¿ç¨‹ç¨‹åºå‡ºç°å†…å­˜å¯è§æ€§é—®é¢˜ã€‚å¯¹äºç¼–è¯‘å™¨ï¼ŒJMM çš„ç¼–è¯‘å™¨é‡æ’åºè§„åˆ™ä¼šç¦æ­¢ç‰¹å®šç±»å‹çš„ç¼–è¯‘å™¨é‡æ’åºï¼ˆä¸æ˜¯æ‰€æœ‰çš„ç¼–è¯‘å™¨é‡æ’åºéƒ½è¦ç¦æ­¢ï¼‰ã€‚å¯¹äºå¤„ç†å™¨é‡æ’åºï¼ŒJMM çš„å¤„ç†å™¨é‡æ’åºè§„åˆ™ä¼šè¦æ±‚ java ç¼–è¯‘å™¨åœ¨ç”ŸæˆæŒ‡ä»¤åºåˆ—æ—¶ï¼Œæ’å…¥ç‰¹å®šç±»å‹çš„å†…å­˜å±éšœï¼ˆmemory barriersï¼Œintel ç§°ä¹‹ä¸º memory fenceï¼‰æŒ‡ä»¤ï¼Œé€šè¿‡å†…å­˜å±éšœæŒ‡ä»¤æ¥ç¦æ­¢ç‰¹å®šç±»å‹çš„å¤„ç†å™¨é‡æ’åºï¼ˆä¸æ˜¯æ‰€æœ‰çš„å¤„ç†å™¨é‡æ’åºéƒ½è¦ç¦æ­¢ï¼‰ã€‚")]),a._v(" "),n("p",[a._v("å…·ä½“å¯ä»¥å‚çœ‹ï¼š"),n("RouterLink",{attrs:{to:"notion://www.notion.so/md/java/jvm/java-jvm-jmm.html"}},[a._v("Java å†…å­˜æ¨¡å‹è¯¦è§£")]),a._v("çš„é‡æ’åºç« èŠ‚ã€‚")],1),a._v(" "),n("h2",{attrs:{id:"javaæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„-jmm-javaå†…å­˜æ¨¡å‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#javaæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„-jmm-javaå†…å­˜æ¨¡å‹"}},[a._v("#")]),a._v(" JAVAæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„: JMM(Javaå†…å­˜æ¨¡å‹)")]),a._v(" "),n("p",[a._v("Java å†…å­˜æ¨¡å‹æ˜¯ä¸ªå¾ˆå¤æ‚çš„è§„èŒƒï¼Œå¼ºçƒˆæ¨èä½ çœ‹åç»­ï¼ˆåº”è¯¥æ˜¯ç½‘ä¸Šèƒ½æ‰¾åˆ°æœ€å¥½çš„ææ–™ä¹‹ä¸€äº†ï¼‰ï¼š"),n("a",{attrs:{href:"https://www.pdai.tech/md/java/jvm/java-jvm-jmm.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Java å†…å­˜æ¨¡å‹è¯¦è§£"),n("OutboundLink")],1),a._v("ã€‚")]),a._v(" "),n("p",[n("strong",[a._v("ç†è§£çš„ç¬¬ä¸€ä¸ªç»´åº¦ï¼šæ ¸å¿ƒçŸ¥è¯†ç‚¹")])]),a._v(" "),n("p",[a._v("JMMæœ¬è´¨ä¸Šå¯ä»¥ç†è§£ä¸ºï¼ŒJava å†…å­˜æ¨¡å‹è§„èŒƒäº† JVM å¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™äº›æ–¹æ³•åŒ…æ‹¬ï¼š")]),a._v(" "),n("ul",[n("li",[a._v("volatileã€synchronized å’Œ final ä¸‰ä¸ªå…³é”®å­—")]),a._v(" "),n("li",[a._v("Happens-Before è§„åˆ™")])]),a._v(" "),n("p",[n("strong",[a._v("ç†è§£çš„ç¬¬äºŒä¸ªç»´åº¦ï¼šå¯è§æ€§ï¼Œæœ‰åºæ€§ï¼ŒåŸå­æ€§")])]),a._v(" "),n("ul",[n("li",[a._v("åŸå­æ€§")])]),a._v(" "),n("p",[a._v("åœ¨Javaä¸­ï¼Œå¯¹åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡çš„è¯»å–å’Œèµ‹å€¼æ“ä½œæ˜¯åŸå­æ€§æ“ä½œï¼Œå³è¿™äº›æ“ä½œæ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼Œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚\nè¯·åˆ†æä»¥ä¸‹å“ªäº›æ“ä½œæ˜¯åŸå­æ€§æ“ä½œï¼š")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("x = 10;        //è¯­å¥1: ç›´æ¥å°†æ•°å€¼10èµ‹å€¼ç»™xï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹æ‰§è¡Œè¿™ä¸ªè¯­å¥çš„ä¼šç›´æ¥å°†æ•°å€¼10å†™å…¥åˆ°å·¥ä½œå†…å­˜ä¸­\ny = x;         //è¯­å¥2: åŒ…å«2ä¸ªæ“ä½œï¼Œå®ƒå…ˆè¦å»è¯»å–xçš„å€¼ï¼Œå†å°†xçš„å€¼å†™å…¥å·¥ä½œå†…å­˜ï¼Œè™½ç„¶è¯»å–xçš„å€¼ä»¥åŠ å°†xçš„å€¼å†™å…¥å·¥ä½œå†…å­˜ è¿™2ä¸ªæ“ä½œéƒ½æ˜¯åŸå­æ€§æ“ä½œï¼Œä½†æ˜¯åˆèµ·æ¥å°±ä¸æ˜¯åŸå­æ€§æ“ä½œäº†ã€‚\nx++;           //è¯­å¥3ï¼š x++åŒ…æ‹¬3ä¸ªæ“ä½œï¼šè¯»å–xçš„å€¼ï¼Œè¿›è¡ŒåŠ 1æ“ä½œï¼Œå†™å…¥æ–°çš„å€¼ã€‚\nx = x + 1;     //è¯­å¥4ï¼š åŒè¯­å¥3\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("ä¸Šé¢4ä¸ªè¯­å¥åªæœ‰è¯­å¥1çš„æ“ä½œå…·å¤‡åŸå­æ€§ã€‚")]),a._v(" "),n("p",[a._v("ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ç®€å•çš„è¯»å–ã€èµ‹å€¼ï¼ˆè€Œä¸”å¿…é¡»æ˜¯å°†æ•°å­—èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œå˜é‡ä¹‹é—´çš„ç›¸äº’èµ‹å€¼ä¸æ˜¯åŸå­æ“ä½œï¼‰æ‰æ˜¯åŸå­æ“ä½œã€‚")]),a._v(" "),n("blockquote",[n("p",[a._v("ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒJavaå†…å­˜æ¨¡å‹åªä¿è¯äº†åŸºæœ¬è¯»å–å’Œèµ‹å€¼æ˜¯åŸå­æ€§æ“ä½œï¼Œå¦‚æœè¦å®ç°æ›´å¤§èŒƒå›´æ“ä½œçš„åŸå­æ€§ï¼Œå¯ä»¥é€šè¿‡synchronizedå’ŒLockæ¥å®ç°ã€‚ç”±äºsynchronizedå’ŒLockèƒ½å¤Ÿä¿è¯ä»»ä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥ä»£ç å—ï¼Œé‚£ä¹ˆè‡ªç„¶å°±ä¸å­˜åœ¨åŸå­æ€§é—®é¢˜äº†ï¼Œä»è€Œä¿è¯äº†åŸå­æ€§ã€‚")])]),a._v(" "),n("ul",[n("li",[a._v("å¯è§æ€§")])]),a._v(" "),n("p",[a._v("Javaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§ã€‚")]),a._v(" "),n("p",[a._v("å½“ä¸€ä¸ªå…±äº«å˜é‡è¢«volatileä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚")]),a._v(" "),n("p",[a._v("è€Œæ™®é€šçš„å…±äº«å˜é‡ä¸èƒ½ä¿è¯å¯è§æ€§ï¼Œå› ä¸ºæ™®é€šå…±äº«å˜é‡è¢«ä¿®æ”¹ä¹‹åï¼Œä»€ä¹ˆæ—¶å€™è¢«å†™å…¥ä¸»å­˜æ˜¯ä¸ç¡®å®šçš„ï¼Œå½“å…¶ä»–çº¿ç¨‹å»è¯»å–æ—¶ï¼Œæ­¤æ—¶å†…å­˜ä¸­å¯èƒ½è¿˜æ˜¯åŸæ¥çš„æ—§å€¼ï¼Œå› æ­¤æ— æ³•ä¿è¯å¯è§æ€§ã€‚")]),a._v(" "),n("blockquote",[n("p",[a._v("å¦å¤–ï¼Œé€šè¿‡synchronizedå’ŒLockä¹Ÿèƒ½å¤Ÿä¿è¯å¯è§æ€§ï¼Œsynchronizedå’ŒLockèƒ½ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å–é”ç„¶åæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå¹¶ä¸”åœ¨é‡Šæ”¾é”ä¹‹å‰ä¼šå°†å¯¹å˜é‡çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å­˜å½“ä¸­ã€‚å› æ­¤å¯ä»¥ä¿è¯å¯è§æ€§ã€‚")])]),a._v(" "),n("ul",[n("li",[a._v("æœ‰åºæ€§")])]),a._v(" "),n("p",[a._v("åœ¨Javaé‡Œé¢ï¼Œå¯ä»¥é€šè¿‡volatileå…³é”®å­—æ¥ä¿è¯ä¸€å®šçš„â€œæœ‰åºæ€§â€ï¼ˆå…·ä½“åŸç†åœ¨ä¸‹ä¸€èŠ‚è®²è¿°ï¼‰ã€‚å¦å¤–å¯ä»¥é€šè¿‡synchronizedå’ŒLockæ¥ä¿è¯æœ‰åºæ€§ï¼Œå¾ˆæ˜¾ç„¶ï¼Œsynchronizedå’ŒLockä¿è¯æ¯ä¸ªæ—¶åˆ»æ˜¯æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œç›¸å½“äºæ˜¯è®©çº¿ç¨‹é¡ºåºæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè‡ªç„¶å°±ä¿è¯äº†æœ‰åºæ€§ã€‚å½“ç„¶JMMæ˜¯é€šè¿‡Happens-Before è§„åˆ™æ¥ä¿è¯æœ‰åºæ€§çš„ã€‚")]),a._v(" "),n("h3",{attrs:{id:"å…³é”®å­—-volatileã€synchronized-å’Œ-final"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å…³é”®å­—-volatileã€synchronized-å’Œ-final"}},[a._v("#")]),a._v(" å…³é”®å­—: volatileã€synchronized å’Œ final")]),a._v(" "),n("p",[a._v("ä»¥ä¸‹ä¸‰ç¯‡æ–‡ç« è¯¦ç»†åˆ†æäº†è¿™ä¸‰ä¸ªå…³é”®å­—ï¼š")]),a._v(" "),n("ul",[n("li",[n("strong",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-key-synchronized.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("å…³é”®å­—: synchronizedè¯¦è§£"),n("OutboundLink")],1)])]),a._v(" "),n("li",[n("strong",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-key-volatile.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("å…³é”®å­—: volatileè¯¦è§£"),n("OutboundLink")],1)])]),a._v(" "),n("li",[n("strong",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-key-final.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("å…³é”®å­—: finalè¯¦è§£"),n("OutboundLink")],1)])])]),a._v(" "),n("h3",{attrs:{id:"happens-before-è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#happens-before-è§„åˆ™"}},[a._v("#")]),a._v(" "),n("strong",[a._v("Happens-Before è§„åˆ™")])]),a._v(" "),n("p",[a._v("ä¸Šé¢æåˆ°äº†å¯ä»¥ç”¨ volatile å’Œ synchronized æ¥ä¿è¯æœ‰åºæ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJVM è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚")]),a._v(" "),n("p",[a._v("ä¸Šé¢æåˆ°äº†å¯ä»¥ç”¨ volatile å’Œ synchronized æ¥ä¿è¯æœ‰åºæ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJVM è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚")]),a._v(" "),n("h3",{attrs:{id:"_1-å•ä¸€çº¿ç¨‹åŸåˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-å•ä¸€çº¿ç¨‹åŸåˆ™"}},[a._v("#")]),a._v(" 1. å•ä¸€çº¿ç¨‹åŸåˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Single Thread rule")])]),a._v(" "),n("p",[a._v("åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œåœ¨ç¨‹åºå‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢çš„æ“ä½œã€‚")]),a._v(" "),n("p",[n("img",{attrs:{src:s(739),alt:"Untitled"}})]),a._v(" "),n("h3",{attrs:{id:"_2-ç®¡ç¨‹é”å®šè§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç®¡ç¨‹é”å®šè§„åˆ™"}},[a._v("#")]),a._v(" 2. ç®¡ç¨‹é”å®šè§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Monitor Lock Rule")])]),a._v(" "),n("p",[a._v("ä¸€ä¸ª unlock æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ lock æ“ä½œã€‚")]),a._v(" "),n("p",[n("img",{attrs:{src:s(740),alt:"Untitled"}})]),a._v(" "),n("h3",{attrs:{id:"_3-volatile-å˜é‡è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-volatile-å˜é‡è§„åˆ™"}},[a._v("#")]),a._v(" 3. volatile å˜é‡è§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Volatile Variable Rule")])]),a._v(" "),n("p",[a._v("å¯¹ä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚")]),a._v(" "),n("p",[n("img",{attrs:{src:s(741),alt:"Untitled"}})]),a._v(" "),n("h3",{attrs:{id:"_4-çº¿ç¨‹å¯åŠ¨è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-çº¿ç¨‹å¯åŠ¨è§„åˆ™"}},[a._v("#")]),a._v(" 4. çº¿ç¨‹å¯åŠ¨è§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Thread Start Rule")])]),a._v(" "),n("p",[a._v("Thread å¯¹è±¡çš„ start() æ–¹æ³•è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚")]),a._v(" "),n("p",[n("img",{attrs:{src:s(742),alt:"Untitled"}})]),a._v(" "),n("h3",{attrs:{id:"_5-çº¿ç¨‹åŠ å…¥è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-çº¿ç¨‹åŠ å…¥è§„åˆ™"}},[a._v("#")]),a._v(" 5. çº¿ç¨‹åŠ å…¥è§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Thread Join Rule")])]),a._v(" "),n("p",[a._v("Thread å¯¹è±¡çš„ç»“æŸå…ˆè¡Œå‘ç”Ÿäº join() æ–¹æ³•è¿”å›ã€‚")]),a._v(" "),n("p",[n("img",{attrs:{src:s(743),alt:"Untitled"}})]),a._v(" "),n("h3",{attrs:{id:"_6-çº¿ç¨‹ä¸­æ–­è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-çº¿ç¨‹ä¸­æ–­è§„åˆ™"}},[a._v("#")]),a._v(" 6. çº¿ç¨‹ä¸­æ–­è§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Thread Interruption Rule")])]),a._v(" "),n("p",[a._v("å¯¹çº¿ç¨‹ interrupt() æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ interrupted() æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚")]),a._v(" "),n("h3",{attrs:{id:"_7-å¯¹è±¡ç»ˆç»“è§„åˆ™"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-å¯¹è±¡ç»ˆç»“è§„åˆ™"}},[a._v("#")]),a._v(" 7. å¯¹è±¡ç»ˆç»“è§„åˆ™")]),a._v(" "),n("blockquote",[n("p",[a._v("Finalizer Rule")])]),a._v(" "),n("p",[a._v("ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆ(æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸ)å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„ finalize() æ–¹æ³•çš„å¼€å§‹ã€‚")]),a._v(" "),n("h3",{attrs:{id:"_8-ä¼ é€’æ€§"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-ä¼ é€’æ€§"}},[a._v("#")]),a._v(" 8. ä¼ é€’æ€§")]),a._v(" "),n("blockquote",[n("p",[a._v("Transitivity")])]),a._v(" "),n("p",[a._v("å¦‚æœæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œæ“ä½œ B å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cï¼Œé‚£ä¹ˆæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cã€‚")]),a._v(" "),n("h2",{attrs:{id:"çº¿ç¨‹å®‰å…¨-ä¸æ˜¯ä¸€ä¸ªéçœŸå³å‡çš„å‘½é¢˜"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹å®‰å…¨-ä¸æ˜¯ä¸€ä¸ªéçœŸå³å‡çš„å‘½é¢˜"}},[a._v("#")]),a._v(" çº¿ç¨‹å®‰å…¨: ä¸æ˜¯ä¸€ä¸ªéçœŸå³å‡çš„å‘½é¢˜")]),a._v(" "),n("p",[a._v("ä¸€ä¸ªç±»åœ¨å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å®‰å…¨è°ƒç”¨æ—¶å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚")]),a._v(" "),n("p",[a._v("çº¿ç¨‹å®‰å…¨ä¸æ˜¯ä¸€ä¸ªéçœŸå³å‡çš„å‘½é¢˜ï¼Œå¯ä»¥å°†å…±äº«æ•°æ®æŒ‰ç…§å®‰å…¨ç¨‹åº¦çš„å¼ºå¼±é¡ºåºåˆ†æˆä»¥ä¸‹äº”ç±»: ä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ã€‚")]),a._v(" "),n("h3",{attrs:{id:"_1-ä¸å¯å˜"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸å¯å˜"}},[a._v("#")]),a._v(" 1.ä¸å¯å˜")]),a._v(" "),n("p",[a._v("ä¸å¯å˜(Immutable)çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸éœ€è¦å†é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚")]),a._v(" "),n("p",[a._v("å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œåº”å½“å°½é‡ä½¿å¯¹è±¡æˆä¸ºä¸å¯å˜ï¼Œæ¥æ»¡è¶³çº¿ç¨‹å®‰å…¨ã€‚")]),a._v(" "),n("p",[a._v("ä¸å¯å˜çš„ç±»å‹:")]),a._v(" "),n("ul",[n("li",[a._v("final å…³é”®å­—ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹")]),a._v(" "),n("li",[a._v("String")]),a._v(" "),n("li",[a._v("æšä¸¾ç±»å‹")]),a._v(" "),n("li",[a._v("Number éƒ¨åˆ†å­ç±»ï¼Œå¦‚ Long å’Œ Double ç­‰æ•°å€¼åŒ…è£…ç±»å‹ï¼ŒBigInteger å’Œ BigDecimal ç­‰å¤§æ•°æ®ç±»å‹ã€‚ä½†åŒä¸º Number çš„åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™æ˜¯å¯å˜çš„ã€‚")])]),a._v(" "),n("p",[a._v("å¯¹äºé›†åˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ Collections.unmodifiableXXX() æ–¹æ³•æ¥è·å–ä¸€ä¸ªä¸å¯å˜çš„é›†åˆã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('public class ImmutableExample {\n    public static void main(String[] args) {\n        Map<String, Integer> map = new HashMap<>();\n        Map<String, Integer> unmodifiableMap = Collections.unmodifiableMap(map);\n        unmodifiableMap.put("a", 1);\n    }\n}\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('Exception in thread "main" java.lang.UnsupportedOperationException\n    at java.util.Collections$UnmodifiableMap.put(Collections.java:1457)\n    at ImmutableExample.main(ImmutableExample.java:9)\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("p",[a._v("Collections.unmodifiableXXX() å…ˆå¯¹åŸå§‹çš„é›†åˆè¿›è¡Œæ‹·è´ï¼Œéœ€è¦å¯¹é›†åˆè¿›è¡Œä¿®æ”¹çš„æ–¹æ³•éƒ½ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("V")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("K")]),a._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("V")]),a._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throw")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("UnsupportedOperationException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("h3",{attrs:{id:"_2-ç»å¯¹çº¿ç¨‹å®‰å…¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç»å¯¹çº¿ç¨‹å®‰å…¨"}},[a._v("#")]),a._v(" 2. ç»å¯¹çº¿ç¨‹å®‰å…¨")]),a._v(" "),n("p",[a._v("ä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒå¦‚ä½•ï¼Œè°ƒç”¨è€…éƒ½ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æªæ–½ã€‚")]),a._v(" "),n("h3",{attrs:{id:"_3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨"}},[a._v("#")]),a._v(" 3. ç›¸å¯¹çº¿ç¨‹å®‰å…¨")]),a._v(" "),n("p",[a._v("ç›¸å¯¹çº¿ç¨‹å®‰å…¨éœ€è¦ä¿è¯å¯¹è¿™ä¸ªå¯¹è±¡å•ç‹¬çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦åšé¢å¤–çš„ä¿éšœæªæ–½ã€‚ä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è¿ç»­è°ƒç”¨ï¼Œå°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿è¯è°ƒç”¨çš„æ­£ç¡®æ€§ã€‚")]),a._v(" "),n("p",[a._v("åœ¨ Java è¯­è¨€ä¸­ï¼Œå¤§éƒ¨åˆ†çš„çº¿ç¨‹å®‰å…¨ç±»éƒ½å±äºè¿™ç§ç±»å‹ï¼Œä¾‹å¦‚ Vectorã€HashTableã€Collections çš„ synchronizedCollection() æ–¹æ³•åŒ…è£…çš„é›†åˆç­‰ã€‚")]),a._v(" "),n("p",[a._v("å¯¹äºä¸‹é¢çš„ä»£ç ï¼Œå¦‚æœåˆ é™¤å…ƒç´ çš„çº¿ç¨‹åˆ é™¤äº† Vector çš„ä¸€ä¸ªå…ƒç´ ï¼Œè€Œè·å–å…ƒç´ çš„çº¿ç¨‹è¯•å›¾è®¿é—®ä¸€ä¸ªå·²ç»è¢«åˆ é™¤çš„å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º ArrayIndexOutOfBoundsExceptionã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public class VectorUnsafeExample {\n    private static Vector<Integer> vector = new Vector<>();\n\n    public static void main(String[] args) {\n        while (true) {\n            for (int i = 0; i < 100; i++) {\n                vector.add(i);\n            }\n            ExecutorService executorService = Executors.newCachedThreadPool();\n            executorService.execute(() -> {\n                for (int i = 0; i < vector.size(); i++) {\n                    vector.remove(i);\n                }\n            });\n            executorService.execute(() -> {\n                for (int i = 0; i < vector.size(); i++) {\n                    vector.get(i);\n                }\n            });\n            executorService.shutdown();\n        }\n    }\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('Exception in thread "Thread-159738" java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 3\n    at java.util.Vector.remove(Vector.java:831)\n    at VectorUnsafeExample.lambda$main$0(VectorUnsafeExample.java:14)\n    at VectorUnsafeExample$$Lambda$1/713338599.run(Unknown Source)\n    at java.lang.Thread.run(Thread.java:745)\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("p",[a._v("å¦‚æœè¦ä¿è¯ä¸Šé¢çš„ä»£ç èƒ½æ­£ç¡®æ‰§è¡Œä¸‹å»ï¼Œå°±éœ€è¦å¯¹åˆ é™¤å…ƒç´ å’Œè·å–å…ƒç´ çš„ä»£ç è¿›è¡ŒåŒæ­¥ã€‚")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[a._v("executorService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("execute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("synchronized")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("remove")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nexecutorService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("execute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("synchronized")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            vector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br")])]),n("h3",{attrs:{id:"_4-çº¿ç¨‹å…¼å®¹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-çº¿ç¨‹å…¼å®¹"}},[a._v("#")]),a._v(" 4. çº¿ç¨‹å…¼å®¹")]),a._v(" "),n("p",[a._v("çº¿ç¨‹å…¼å®¹æ˜¯æŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ï¼Œæˆ‘ä»¬å¹³å¸¸è¯´ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç»å¤§å¤šæ•°æ—¶å€™æŒ‡çš„æ˜¯è¿™ä¸€ç§æƒ…å†µã€‚Java API ä¸­å¤§éƒ¨åˆ†çš„ç±»éƒ½æ˜¯å±äºçº¿ç¨‹å…¼å®¹çš„ï¼Œå¦‚ä¸å‰é¢çš„ Vector å’Œ HashTable ç›¸å¯¹åº”çš„é›†åˆç±» ArrayList å’Œ HashMap ç­‰ã€‚")]),a._v(" "),n("h3",{attrs:{id:"_5-çº¿ç¨‹å¯¹ç«‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-çº¿ç¨‹å¯¹ç«‹"}},[a._v("#")]),a._v(" 5. çº¿ç¨‹å¯¹ç«‹")]),a._v(" "),n("p",[a._v("çº¿ç¨‹å¯¹ç«‹æ˜¯æŒ‡æ— è®ºè°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½ï¼Œéƒ½æ— æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨çš„ä»£ç ã€‚ç”±äº Java è¯­è¨€å¤©ç”Ÿå°±å…·å¤‡å¤šçº¿ç¨‹ç‰¹æ€§ï¼Œçº¿ç¨‹å¯¹ç«‹è¿™ç§æ’æ–¥å¤šçº¿ç¨‹çš„ä»£ç æ˜¯å¾ˆå°‘å‡ºç°çš„ï¼Œè€Œä¸”é€šå¸¸éƒ½æ˜¯æœ‰å®³çš„ï¼Œåº”å½“å°½é‡é¿å…ã€‚")]),a._v(" "),n("h2",{attrs:{id:"çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"}},[a._v("#")]),a._v(" çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•")]),a._v(" "),n("h3",{attrs:{id:"_1-äº’æ–¥åŒæ­¥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-äº’æ–¥åŒæ­¥"}},[a._v("#")]),a._v(" 1. äº’æ–¥åŒæ­¥")]),a._v(" "),n("p",[a._v("synchronized å’Œ ReentrantLockã€‚")]),a._v(" "),n("p",[a._v("åˆæ­¥äº†è§£ä½ å¯ä»¥çœ‹ï¼š")]),a._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-thread-basic.html#%E7%BA%BF%E7%A8%8B%E4%BA%92%E6%96%A5%E5%90%8C%E6%AD%A5",target:"_blank",rel:"noopener noreferrer"}},[a._v("Java å¹¶å‘ - çº¿ç¨‹åŸºç¡€ï¼šçº¿ç¨‹äº’æ–¥åŒæ­¥"),n("OutboundLink")],1)])]),a._v(" "),n("p",[a._v("è¯¦ç»†åˆ†æè¯·çœ‹ï¼š")]),a._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-key-synchronized.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("å…³é”®å­—: Synchronizedè¯¦è§£"),n("OutboundLink")],1)]),a._v(" "),n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-lock-ReentrantLock.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCé”: ReentrantLockè¯¦è§£"),n("OutboundLink")],1)])]),a._v(" "),n("h3",{attrs:{id:"_2-éé˜»å¡åŒæ­¥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-éé˜»å¡åŒæ­¥"}},[a._v("#")]),a._v(" 2. éé˜»å¡åŒæ­¥")]),a._v(" "),n("p",[a._v("äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚")]),a._v(" "),n("p",[a._v("äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”(è¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”)ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚")]),a._v(" "),n("p",[n("strong",[a._v("(ä¸€)CAS")])]),a._v(" "),n("p",[a._v("éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥: å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½(ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢)ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚")]),a._v(" "),n("p",[a._v("ä¹è§‚é”éœ€è¦æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œåªèƒ½é ç¡¬ä»¶æ¥å®Œæˆã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯: æ¯”è¾ƒå¹¶äº¤æ¢(Compare-and-Swapï¼ŒCAS)ã€‚CAS æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚")]),a._v(" "),n("p",[n("strong",[a._v("(äºŒ)AtomicInteger")])]),a._v(" "),n("p",[a._v("J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» AtomicIntegerï¼Œå…¶ä¸­çš„ compareAndSet() å’Œ getAndIncrement() ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œã€‚")]),a._v(" "),n("p",[a._v("ä»¥ä¸‹ä»£ç ä½¿ç”¨äº† AtomicInteger æ‰§è¡Œäº†è‡ªå¢çš„æ“ä½œã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("private AtomicInteger cnt = new AtomicInteger();\n\npublic void add() {\n    cnt.incrementAndGet();\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("p",[a._v("ä»¥ä¸‹ä»£ç æ˜¯ incrementAndGet() çš„æºç ï¼Œå®ƒè°ƒç”¨äº† unsafe çš„ getAndAddInt() ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public final int incrementAndGet() {\n    return unsafe.getAndAddInt(this, valueOffset, 1) + 1;\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("p",[a._v("ä»¥ä¸‹ä»£ç æ˜¯ getAndAddInt() æºç ï¼Œvar1 æŒ‡ç¤ºå¯¹è±¡å†…å­˜åœ°å€ï¼Œvar2 æŒ‡ç¤ºè¯¥å­—æ®µç›¸å¯¹å¯¹è±¡å†…å­˜åœ°å€çš„åç§»ï¼Œvar4 æŒ‡ç¤ºæ“ä½œéœ€è¦åŠ çš„æ•°å€¼ï¼Œè¿™é‡Œä¸º 1ã€‚é€šè¿‡ getIntVolatile(var1, var2) å¾—åˆ°æ—§çš„é¢„æœŸå€¼ï¼Œé€šè¿‡è°ƒç”¨ compareAndSwapInt() æ¥è¿›è¡Œ CAS æ¯”è¾ƒï¼Œå¦‚æœè¯¥å­—æ®µå†…å­˜åœ°å€ä¸­çš„å€¼ç­‰äº var5ï¼Œé‚£ä¹ˆå°±æ›´æ–°å†…å­˜åœ°å€ä¸º var1+var2 çš„å˜é‡ä¸º var5+var4ã€‚")]),a._v(" "),n("p",[a._v("å¯ä»¥çœ‹åˆ° getAndAddInt() åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œï¼Œå‘ç”Ÿå†²çªçš„åšæ³•æ˜¯ä¸æ–­çš„è¿›è¡Œé‡è¯•ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n    return var5;\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br")])]),n("p",[n("strong",[a._v("(ä¸‰)ABA")])]),a._v(" "),n("p",[a._v("å¦‚æœä¸€ä¸ªå˜é‡åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå®ƒçš„å€¼è¢«æ”¹æˆäº† Bï¼Œåæ¥åˆè¢«æ”¹å›ä¸º Aï¼Œé‚£ CAS æ“ä½œå°±ä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡ã€‚")]),a._v(" "),n("p",[a._v("J.U.C åŒ…æä¾›äº†ä¸€ä¸ªå¸¦æœ‰æ ‡è®°çš„åŸå­å¼•ç”¨ç±» AtomicStampedReference æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥é€šè¿‡æ§åˆ¶å˜é‡å€¼çš„ç‰ˆæœ¬æ¥ä¿è¯ CAS çš„æ­£ç¡®æ€§ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABA é—®é¢˜ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³ ABA é—®é¢˜ï¼Œæ”¹ç”¨ä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´é«˜æ•ˆã€‚")]),a._v(" "),n("p",[a._v("CAS, Unsafeå’ŒåŸå­ç±»è¯¦ç»†åˆ†æè¯·çœ‹ï¼š")]),a._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-juc-AtomicInteger.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCåŸå­ç±»: CAS, Unsafeå’ŒåŸå­ç±»è¯¦è§£"),n("OutboundLink")],1)])]),a._v(" "),n("h3",{attrs:{id:"_3-æ— åŒæ­¥æ–¹æ¡ˆ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ— åŒæ­¥æ–¹æ¡ˆ"}},[a._v("#")]),a._v(" 3. æ— åŒæ­¥æ–¹æ¡ˆ")]),a._v(" "),n("p",[a._v("è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚")]),a._v(" "),n("p",[n("strong",[a._v("(ä¸€)æ ˆå°é—­")])]),a._v(" "),n("p",[a._v("å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äºçº¿ç¨‹ç§æœ‰çš„ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("import java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class StackClosedExample {\n    public void add100() {\n        int cnt = 0;\n        for (int i = 0; i < 100; i++) {\n            cnt++;\n        }\n        System.out.println(cnt);\n    }\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public static void main(String[] args) {\n    StackClosedExample example = new StackClosedExample();\n    ExecutorService executorService = Executors.newCachedThreadPool();\n    executorService.execute(() -> example.add100());\n    executorService.execute(() -> example.add100());\n    executorService.shutdown();\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("100\n100\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br")])]),n("p",[a._v("æ›´è¯¦ç»†çš„åˆ†æè¯·çœ‹J.U.Cä¸­çº¿ç¨‹æ± ç›¸å…³å†…å®¹è¯¦è§£ï¼š")]),a._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-juc-executor-FutureTask.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCçº¿ç¨‹æ± : FutureTaskè¯¦è§£"),n("OutboundLink")],1)]),a._v(" "),n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-juc-executor-ThreadPoolExecutor.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCçº¿ç¨‹æ± : ThreadPoolExecutorè¯¦è§£"),n("OutboundLink")],1)]),a._v(" "),n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-juc-executor-ScheduledThreadPoolExecutor.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCçº¿ç¨‹æ± : ScheduledThreadPoolè¯¦è§£"),n("OutboundLink")],1)]),a._v(" "),n("li",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-juc-executor-ForkJoinPool.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCçº¿ç¨‹æ± : Fork/Joinæ¡†æ¶è¯¦è§£"),n("OutboundLink")],1)])]),a._v(" "),n("p",[n("strong",[a._v("(äºŒ)çº¿ç¨‹æœ¬åœ°å­˜å‚¨(Thread Local Storage)")])]),a._v(" "),n("p",[a._v("å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚")]),a._v(" "),n("p",[a._v("ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼(å¦‚â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼)éƒ½ä¼šå°†äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹å°½é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ¶ˆè´¹å®Œã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹å°±æ˜¯ç»å…¸ Web äº¤äº’æ¨¡å‹ä¸­çš„â€œä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹â€(Thread-per-Request)çš„å¤„ç†æ–¹å¼ï¼Œè¿™ç§å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ä½¿å¾—å¾ˆå¤š Web æœåŠ¡ç«¯åº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚")]),a._v(" "),n("p",[a._v("å¯ä»¥ä½¿ç”¨ java.lang.ThreadLocal ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨åŠŸèƒ½ã€‚")]),a._v(" "),n("p",[a._v("å¯¹äºä»¥ä¸‹ä»£ç ï¼Œthread1 ä¸­è®¾ç½® threadLocal ä¸º 1ï¼Œè€Œ thread2 è®¾ç½® threadLocal ä¸º 2ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œthread1 è¯»å– threadLocal ä¾ç„¶æ˜¯ 1ï¼Œä¸å— thread2 çš„å½±å“ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public class ThreadLocalExample {\n    public static void main(String[] args) {\n        ThreadLocal threadLocal = new ThreadLocal();\n        Thread thread1 = new Thread(() -> {\n            threadLocal.set(1);\n            try {\n                Thread.sleep(1000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(threadLocal.get());\n            threadLocal.remove();\n        });\n        Thread thread2 = new Thread(() -> {\n            threadLocal.set(2);\n            threadLocal.remove();\n        });\n        thread1.start();\n        thread2.start();\n    }\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br")])]),n("p",[a._v("è¾“å‡ºç»“æœ")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("1\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("p",[a._v("ä¸ºäº†ç†è§£ ThreadLocalï¼Œå…ˆçœ‹ä»¥ä¸‹ä»£ç :")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public class ThreadLocalExample1 {\n    public static void main(String[] args) {\n        ThreadLocal threadLocal1 = new ThreadLocal();\n        ThreadLocal threadLocal2 = new ThreadLocal();\n        Thread thread1 = new Thread(() -> {\n            threadLocal1.set(1);\n            threadLocal2.set(1);\n        });\n        Thread thread2 = new Thread(() -> {\n            threadLocal1.set(2);\n            threadLocal2.set(2);\n        });\n        thread1.start();\n        thread2.start();\n    }\n}\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br")])]),n("p",[a._v("å®ƒæ‰€å¯¹åº”çš„åº•å±‚ç»“æ„å›¾ä¸º:")]),a._v(" "),n("p",[n("img",{attrs:{src:s(744),alt:"Untitled"}})]),a._v(" "),n("p",[a._v("æ¯ä¸ª Thread éƒ½æœ‰ä¸€ä¸ª ThreadLocal.ThreadLocalMap å¯¹è±¡ï¼ŒThread ç±»ä¸­å°±å®šä¹‰äº† ThreadLocal.ThreadLocalMap æˆå‘˜ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("/* ThreadLocal values pertaining to this thread. This map is maintained\n * by the ThreadLocal class. */\nThreadLocal.ThreadLocalMap threadLocals = null;\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("p",[a._v("å½“è°ƒç”¨ä¸€ä¸ª ThreadLocal çš„ set(T value) æ–¹æ³•æ—¶ï¼Œå…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ ThreadLocalMap å¯¹è±¡ï¼Œç„¶åå°† ThreadLocal->value é”®å€¼å¯¹æ’å…¥åˆ°è¯¥ Map ä¸­ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("public void set(T value) {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null)\n        map.set(this, value);\n    else\n        createMap(t, value);\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br")])]),n("p",[a._v("get() æ–¹æ³•ç±»ä¼¼ã€‚")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('public T get() {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null) {\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings("unchecked")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br")])]),n("p",[a._v("ThreadLocal ä»ç†è®ºä¸Šè®²å¹¶ä¸æ˜¯ç”¨æ¥è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜çš„ï¼Œå› ä¸ºæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ã€‚")]),a._v(" "),n("p",[a._v("åœ¨ä¸€äº›åœºæ™¯ (å°¤å…¶æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ) ä¸‹ï¼Œç”±äº ThreadLocal.ThreadLocalMap çš„åº•å±‚æ•°æ®ç»“æ„å¯¼è‡´ ThreadLocal æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œåº”è¯¥å°½å¯èƒ½åœ¨æ¯æ¬¡ä½¿ç”¨ ThreadLocal åæ‰‹åŠ¨è°ƒç”¨ remove()ï¼Œä»¥é¿å…å‡ºç° ThreadLocal ç»å…¸çš„å†…å­˜æ³„æ¼ç”šè‡³æ˜¯é€ æˆè‡ªèº«ä¸šåŠ¡æ··ä¹±çš„é£é™©ã€‚")]),a._v(" "),n("p",[a._v("æ›´è¯¦ç»†çš„åˆ†æçœ‹ï¼š"),n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-threadlocal.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Java å¹¶å‘ - ThreadLocalè¯¦è§£"),n("OutboundLink")],1)]),a._v(" "),n("p",[n("strong",[a._v("(ä¸‰)å¯é‡å…¥ä»£ç (Reentrant Code)")])]),a._v(" "),n("p",[a._v("è¿™ç§ä»£ç ä¹Ÿå«åšçº¯ä»£ç (Pure Code)ï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç (åŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«)ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚")]),a._v(" "),n("p",[a._v("å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼Œä¾‹å¦‚ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚")]),a._v(" "),n("ul",[n("li",[n("strong",[n("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-lock-ReentrantLock.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JUCé”: ReentrantLockè¯¦è§£"),n("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=e.exports}}]);