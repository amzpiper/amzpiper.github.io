(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{727:function(s,n,a){s.exports=a.p+"assets/img/Untitled.fb026cc5.png"},728:function(s,n,a){s.exports=a.p+"assets/img/Untitled1.03c87c18.png"},729:function(s,n,a){s.exports=a.p+"assets/img/Untitled2.6363ea8d.png"},730:function(s,n,a){s.exports=a.p+"assets/img/Untitled3.d3f35838.png"},731:function(s,n,a){s.exports=a.p+"assets/img/Untitled4.8b6a0b98.png"},732:function(s,n,a){s.exports=a.p+"assets/img/Untitled5.090547be.png"},733:function(s,n,a){s.exports=a.p+"assets/img/Untitled6.219a7767.png"},734:function(s,n,a){s.exports=a.p+"assets/img/Untitled7.b88b9970.png"},735:function(s,n,a){s.exports=a.p+"assets/img/Untitled8.a90d148b.png"},829:function(s,n,a){"use strict";a.r(n);var t=a(24),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"å…³é”®å­—-synchronized"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å…³é”®å­—-synchronized"}},[s._v("#")]),s._v(" å…³é”®å­—-synchronized")]),s._v(" "),t("aside",[s._v("\nğŸ’¡ åœ¨Cç¨‹åºä»£ç ä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„äº’æ–¥é”æ¥å®ç°åŒæ­¥å—çš„äº’æ–¥è®¿é—®åŠçº¿ç¨‹çš„é˜»å¡åŠå”¤é†’ç­‰å·¥ä½œã€‚åœ¨Javaä¸­é™¤äº†æä¾›Lock APIå¤–è¿˜åœ¨è¯­æ³•å±‚é¢ä¸Šæä¾›äº†synchronizedå…³é”®å­—æ¥å®ç°äº’æ–¥åŒæ­¥åŸè¯­, æœ¬æ–‡å°†å¯¹synchronizedå…³é”®å­—è¯¦ç»†åˆ†æã€‚\n")]),s._v(" "),t("h2",{attrs:{id:"å¸¦ç€batå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£synchronized"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¸¦ç€batå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£synchronized"}},[s._v("#")]),s._v(" å¸¦ç€BATå¤§å‚çš„é¢è¯•é—®é¢˜å»ç†è§£Synchronized")]),s._v(" "),t("p",[s._v("è¯·å¸¦ç€è¿™äº›é—®é¢˜ç»§ç»­åæ–‡ï¼Œä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå¸®åŠ©ä½ æ›´å¥½çš„ç†è§£synchronizedã€‚")]),s._v(" "),t("ul",[t("li",[s._v("Synchronizedå¯ä»¥"),t("strong",[s._v("ä½œç”¨")]),s._v("åœ¨å“ªé‡Œ? åˆ†åˆ«é€šè¿‡"),t("strong",[s._v("å¯¹è±¡é”")]),s._v("å’Œ"),t("strong",[s._v("ç±»é”")]),s._v("è¿›è¡Œä¸¾ä¾‹ã€‚")]),s._v(" "),t("li",[s._v("Synchronizedæœ¬è´¨ä¸Šæ˜¯"),t("strong",[s._v("é€šè¿‡ä»€ä¹ˆä¿è¯çº¿ç¨‹å®‰å…¨")]),s._v("çš„? åˆ†ä¸‰ä¸ªæ–¹é¢å›ç­”ï¼š"),t("strong",[s._v("åŠ é”å’Œé‡Šæ”¾é”çš„åŸç†")]),s._v("ï¼Œ"),t("strong",[s._v("å¯é‡å…¥åŸç†")]),s._v("ï¼Œä¿è¯"),t("strong",[s._v("å¯è§æ€§åŸç†")]),s._v("ã€‚")]),s._v(" "),t("li",[s._v("Synchronizedç”±ä»€ä¹ˆæ ·çš„"),t("strong",[s._v("ç¼ºé™·")]),s._v("? Java "),t("strong",[s._v("Lockæ˜¯æ€ä¹ˆå¼¥è¡¥")]),s._v("è¿™äº›ç¼ºé™·çš„ã€‚")]),s._v(" "),t("li",[s._v("Synchronizedå’ŒLockçš„"),t("strong",[s._v("å¯¹æ¯”")]),s._v("ï¼Œå’Œé€‰æ‹©?")]),s._v(" "),t("li",[s._v("Synchronizedåœ¨ä½¿ç”¨æ—¶æœ‰ä½•"),t("strong",[s._v("æ³¨æ„äº‹é¡¹")]),s._v("?")]),s._v(" "),t("li",[s._v("Synchronizedä¿®é¥°çš„æ–¹æ³•åœ¨"),t("strong",[s._v("æŠ›å‡ºå¼‚å¸¸æ—¶,ä¼šé‡Šæ”¾é”å—")]),s._v("?")]),s._v(" "),t("li",[s._v("å¤šä¸ªçº¿ç¨‹ç­‰å¾…åŒä¸€ä¸ªsnchronizedé”çš„æ—¶å€™ï¼ŒJVMå¦‚ä½•"),t("strong",[s._v("é€‰æ‹©ä¸‹ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹")]),s._v("?")]),s._v(" "),t("li",[s._v("Synchronizedä½¿å¾—åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼Œæ€§èƒ½æ¯”è¾ƒå·®ï¼Œæœ‰ä»€ä¹ˆ"),t("strong",[s._v("æå‡æ€§èƒ½çš„æ–¹æ³•")]),s._v("?")]),s._v(" "),t("li",[s._v("æˆ‘"),t("strong",[s._v("æƒ³æ›´åŠ çµæ´»åœ°æ§åˆ¶é”çš„é‡Šæ”¾å’Œè·å–")]),s._v("(ç°åœ¨é‡Šæ”¾é”å’Œè·å–é”çš„æ—¶æœºéƒ½è¢«è§„å®šæ­»äº†)ï¼Œæ€ä¹ˆåŠ?")]),s._v(" "),t("li",[s._v("ä»€ä¹ˆæ˜¯"),t("strong",[s._v("é”çš„å‡çº§å’Œé™çº§")]),s._v("? ä»€ä¹ˆæ˜¯JVMé‡Œçš„"),t("strong",[s._v("åæ–œé”ã€è½»é‡çº§é”ã€é‡é‡çº§é”")]),s._v("?")]),s._v(" "),t("li",[t("strong",[s._v("ä¸åŒçš„JDKä¸­å¯¹Synchronizedæœ‰ä½•ä¼˜åŒ–")]),s._v("?")])]),s._v(" "),t("h2",{attrs:{id:"synchronizedçš„ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#synchronizedçš„ä½¿ç”¨"}},[s._v("#")]),s._v(" Synchronizedçš„ä½¿ç”¨")]),s._v(" "),t("p",[s._v("åœ¨åº”ç”¨Sychronizedå…³é”®å­—æ—¶éœ€è¦æŠŠæ¡å¦‚ä¸‹æ³¨æ„ç‚¹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä¸€æŠŠé”åªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹è·å–ï¼Œæ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹åªèƒ½ç­‰å¾…ï¼›")]),s._v(" "),t("li",[s._v("æ¯ä¸ªå®ä¾‹éƒ½å¯¹åº”æœ‰è‡ªå·±çš„ä¸€æŠŠé”(this),ä¸åŒå®ä¾‹ä¹‹é—´äº’ä¸å½±å“ï¼›ä¾‹å¤–ï¼šé”å¯¹è±¡æ˜¯*.classä»¥åŠsynchronizedä¿®é¥°çš„æ˜¯staticæ–¹æ³•çš„æ—¶å€™ï¼Œæ‰€æœ‰å¯¹è±¡å…¬ç”¨åŒä¸€æŠŠé”")]),s._v(" "),t("li",[s._v("synchronizedä¿®é¥°çš„æ–¹æ³•ï¼Œæ— è®ºæ–¹æ³•æ­£å¸¸æ‰§è¡Œå®Œæ¯•è¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œéƒ½ä¼šé‡Šæ”¾é”")])]),s._v(" "),t("h3",{attrs:{id:"å¯¹è±¡é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡é”"}},[s._v("#")]),s._v(" å¯¹è±¡é”")]),s._v(" "),t("p",[s._v("åŒ…æ‹¬æ–¹æ³•é”(é»˜è®¤é”å¯¹è±¡ä¸ºthis,å½“å‰å®ä¾‹å¯¹è±¡)å’ŒåŒæ­¥ä»£ç å—é”(è‡ªå·±æŒ‡å®šé”å¯¹è±¡)")]),s._v(" "),t("h3",{attrs:{id:"ä»£ç å—å½¢å¼-æ‰‹åŠ¨æŒ‡å®šé”å®šå¯¹è±¡-ä¹Ÿå¯æ˜¯æ˜¯this-ä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç å—å½¢å¼-æ‰‹åŠ¨æŒ‡å®šé”å®šå¯¹è±¡-ä¹Ÿå¯æ˜¯æ˜¯this-ä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„é”"}},[s._v("#")]),s._v(" "),t("strong",[s._v("ä»£ç å—å½¢å¼ï¼šæ‰‹åŠ¨æŒ‡å®šé”å®šå¯¹è±¡ï¼Œä¹Ÿå¯æ˜¯æ˜¯this,ä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„é”")])]),s._v(" "),t("ul",[t("li",[s._v("ç¤ºä¾‹1")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence = new SynchronizedObjectLock();\n\n    @Override\n    public void run() {\n        // åŒæ­¥ä»£ç å—å½¢å¼â€”â€”é”ä¸ºthis,ä¸¤ä¸ªçº¿ç¨‹ä½¿ç”¨çš„é”æ˜¯ä¸€æ ·çš„,çº¿ç¨‹1å¿…é¡»è¦ç­‰åˆ°çº¿ç¨‹0é‡Šæ”¾äº†è¯¥é”åï¼Œæ‰èƒ½æ‰§è¡Œ\n        synchronized (this) {\n            System.out.println("æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n            try {\n                Thread.sleep(3000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(Thread.currentThread().getName() + "ç»“æŸ");\n        }\n    }\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(instence);\n        Thread t2 = new Thread(instence);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("æˆ‘æ˜¯çº¿ç¨‹Thread-0\nThread-0ç»“æŸ\næˆ‘æ˜¯çº¿ç¨‹Thread-1\nThread-1ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("ç¤ºä¾‹2")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence = new SynchronizedObjectLock();\n    // åˆ›å»º2æŠŠé”\n    Object block1 = new Object();\n    Object block2 = new Object();\n\n    @Override\n    public void run() {\n        // è¿™ä¸ªä»£ç å—ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€æŠŠé”ï¼Œå½“ä»–é‡Šæ”¾åï¼Œåé¢çš„ä»£ç å—ç”±äºä½¿ç”¨çš„æ˜¯ç¬¬äºŒæŠŠé”ï¼Œå› æ­¤å¯ä»¥é©¬ä¸Šæ‰§è¡Œ\n        synchronized (block1) {\n            System.out.println("block1é”,æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n            try {\n                Thread.sleep(3000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println("block1é”,"+Thread.currentThread().getName() + "ç»“æŸ");\n        }\n\n        synchronized (block2) {\n            System.out.println("block2é”,æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n            try {\n                Thread.sleep(3000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println("block2é”,"+Thread.currentThread().getName() + "ç»“æŸ");\n        }\n    }\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(instence);\n        Thread t2 = new Thread(instence);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("block1é”,æˆ‘æ˜¯çº¿ç¨‹Thread-0\nblock1é”,Thread-0ç»“æŸ\nblock2é”,æˆ‘æ˜¯çº¿ç¨‹Thread-0ã€€ã€€// å¯ä»¥çœ‹åˆ°å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå®Œç¬¬ä¸€æ®µåŒæ­¥ä»£ç å—ä¹‹åï¼Œç¬¬äºŒä¸ªåŒæ­¥ä»£ç å—å¯ä»¥é©¬ä¸Šå¾—åˆ°æ‰§è¡Œï¼Œå› ä¸ºä»–ä»¬ä½¿ç”¨çš„é”ä¸æ˜¯åŒä¸€æŠŠ\nblock1é”,æˆ‘æ˜¯çº¿ç¨‹Thread-1\nblock2é”,Thread-0ç»“æŸ\nblock1é”,Thread-1ç»“æŸ\nblock2é”,æˆ‘æ˜¯çº¿ç¨‹Thread-1\nblock2é”,Thread-1ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"æ–¹æ³•é”å½¢å¼-synchronizedä¿®é¥°æ™®é€šæ–¹æ³•-é”å¯¹è±¡é»˜è®¤ä¸ºthis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•é”å½¢å¼-synchronizedä¿®é¥°æ™®é€šæ–¹æ³•-é”å¯¹è±¡é»˜è®¤ä¸ºthis"}},[s._v("#")]),s._v(" æ–¹æ³•é”å½¢å¼ï¼šsynchronizedä¿®é¥°æ™®é€šæ–¹æ³•ï¼Œé”å¯¹è±¡é»˜è®¤ä¸ºthis")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence = new SynchronizedObjectLock();\n\n    @Override\n    public void run() {\n        method();\n    }\n\n    public synchronized void method() {\n        System.out.println("æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n        try {\n            Thread.sleep(3000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + "ç»“æŸ");\n    }\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(instence);\n        Thread t2 = new Thread(instence);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("æˆ‘æ˜¯çº¿ç¨‹Thread-0\nThread-0ç»“æŸ\næˆ‘æ˜¯çº¿ç¨‹Thread-1\nThread-1ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"ç±»é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç±»é”"}},[s._v("#")]),s._v(" ç±»é”")]),s._v(" "),t("p",[s._v("æŒ‡synchronizeä¿®é¥°é™æ€çš„æ–¹æ³•æˆ–æŒ‡å®šé”å¯¹è±¡ä¸ºClasså¯¹è±¡")]),s._v(" "),t("p",[t("strong",[s._v("synchronizeä¿®é¥°é™æ€æ–¹æ³•")])]),s._v(" "),t("ul",[t("li",[s._v("ç¤ºä¾‹1")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence1 = new SynchronizedObjectLock();\n    static SynchronizedObjectLock instence2 = new SynchronizedObjectLock();\n\n    @Override\n    public void run() {\n        method();\n    }\n\n    // synchronizedç”¨åœ¨æ™®é€šæ–¹æ³•ä¸Šï¼Œé»˜è®¤çš„é”å°±æ˜¯thisï¼Œå½“å‰å®ä¾‹\n    public synchronized void method() {\n        System.out.println("æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n        try {\n            Thread.sleep(3000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + "ç»“æŸ");\n    }\n\n    public static void main(String[] args) {\n        // t1å’Œt2å¯¹åº”çš„thisæ˜¯ä¸¤ä¸ªä¸åŒçš„å®ä¾‹ï¼Œæ‰€ä»¥ä»£ç ä¸ä¼šä¸²è¡Œ\n        Thread t1 = new Thread(instence1);\n        Thread t2 = new Thread(instence2);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("æˆ‘æ˜¯çº¿ç¨‹Thread-0\næˆ‘æ˜¯çº¿ç¨‹Thread-1\nThread-1ç»“æŸ\nThread-0ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("ç¤ºä¾‹2")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence1 = new SynchronizedObjectLock();\n    static SynchronizedObjectLock instence2 = new SynchronizedObjectLock();\n\n    @Override\n    public void run() {\n        method();\n    }\n\n    // synchronizedç”¨åœ¨é™æ€æ–¹æ³•ä¸Šï¼Œé»˜è®¤çš„é”å°±æ˜¯å½“å‰æ‰€åœ¨çš„Classç±»ï¼Œæ‰€ä»¥æ— è®ºæ˜¯å“ªä¸ªçº¿ç¨‹è®¿é—®å®ƒï¼Œéœ€è¦çš„é”éƒ½åªæœ‰ä¸€æŠŠ\n    public static synchronized void method() {\n        System.out.println("æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n        try {\n            Thread.sleep(3000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + "ç»“æŸ");\n    }\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(instence1);\n        Thread t2 = new Thread(instence2);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("æˆ‘æ˜¯çº¿ç¨‹Thread-0\nThread-0ç»“æŸ\næˆ‘æ˜¯çº¿ç¨‹Thread-1\nThread-1ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("synchronizedæŒ‡å®šé”å¯¹è±¡ä¸ºClasså¯¹è±¡")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('public class SynchronizedObjectLock implements Runnable {\n    static SynchronizedObjectLock instence1 = new SynchronizedObjectLock();\n    static SynchronizedObjectLock instence2 = new SynchronizedObjectLock();\n\n    @Override\n    public void run() {\n        // æ‰€æœ‰çº¿ç¨‹éœ€è¦çš„é”éƒ½æ˜¯åŒä¸€æŠŠ\n        synchronized(SynchronizedObjectLock.class){\n            System.out.println("æˆ‘æ˜¯çº¿ç¨‹" + Thread.currentThread().getName());\n            try {\n                Thread.sleep(3000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(Thread.currentThread().getName() + "ç»“æŸ");\n        }\n    }\n\n    public static void main(String[] args) {\n        Thread t1 = new Thread(instence1);\n        Thread t2 = new Thread(instence2);\n        t1.start();\n        t2.start();\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("è¾“å‡ºç»“æœï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("æˆ‘æ˜¯çº¿ç¨‹"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("ç»“æŸ\næˆ‘æ˜¯çº¿ç¨‹"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("ç»“æŸ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"synchronizedåŸç†åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#synchronizedåŸç†åˆ†æ"}},[s._v("#")]),s._v(" SynchronizedåŸç†åˆ†æ")]),s._v(" "),t("h3",{attrs:{id:"åŠ é”å’Œé‡Šæ”¾é”çš„åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŠ é”å’Œé‡Šæ”¾é”çš„åŸç†"}},[s._v("#")]),s._v(" åŠ é”å’Œé‡Šæ”¾é”çš„åŸç†")]),s._v(" "),t("blockquote",[t("p",[s._v("ç°è±¡ã€æ—¶æœº(å†…ç½®é”this)ã€æ·±å…¥JVMçœ‹å­—èŠ‚ç (åç¼–è¯‘çœ‹monitoræŒ‡ä»¤)")])]),s._v(" "),t("p",[s._v("æ·±å…¥JVMçœ‹å­—èŠ‚ç ï¼Œåˆ›å»ºå¦‚ä¸‹çš„ä»£ç ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("public class SynchronizedDemo2 {\n\n    Object object = new Object();\n    public void method1() {\n        synchronized (object) {\n\n        }\n        method2();\n    }\n\n    private static void method2() {\n\n    }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("ä½¿ç”¨javacå‘½ä»¤è¿›è¡Œç¼–è¯‘ç”Ÿæˆ.classæ–‡ä»¶")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">javac SynchronizedDemo2.java\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½¿ç”¨javapå‘½ä»¤åç¼–è¯‘æŸ¥çœ‹.classæ–‡ä»¶çš„ä¿¡æ¯")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">javap -verbose SynchronizedDemo2.class\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("å¾—åˆ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(727),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("å…³æ³¨çº¢è‰²æ–¹æ¡†é‡Œçš„"),t("code",[s._v("monitorenter")]),s._v("å’Œ"),t("code",[s._v("monitorexit")]),s._v("å³å¯ã€‚")]),s._v(" "),t("p",[t("code",[s._v("Monitorenter")]),s._v("å’Œ"),t("code",[s._v("Monitorexit")]),s._v("æŒ‡ä»¤ï¼Œä¼šè®©å¯¹è±¡åœ¨æ‰§è¡Œï¼Œä½¿å…¶é”è®¡æ•°å™¨åŠ 1æˆ–è€…å‡1ã€‚æ¯ä¸€ä¸ªå¯¹è±¡åœ¨åŒä¸€æ—¶é—´åªä¸ä¸€ä¸ªmonitor(é”)ç›¸å…³è”ï¼Œè€Œä¸€ä¸ªmonitoråœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å¾—ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨å°è¯•è·å¾—ä¸è¿™ä¸ªå¯¹è±¡ç›¸å…³è”çš„Monitoré”çš„æ‰€æœ‰æƒçš„æ—¶å€™ï¼ŒmonitorenteræŒ‡ä»¤ä¼šå‘ç”Ÿå¦‚ä¸‹3ä¸­æƒ…å†µä¹‹ä¸€ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("monitorè®¡æ•°å™¨ä¸º0ï¼Œæ„å‘³ç€ç›®å‰è¿˜æ²¡æœ‰è¢«è·å¾—ï¼Œé‚£è¿™ä¸ªçº¿ç¨‹å°±ä¼šç«‹åˆ»è·å¾—ç„¶åæŠŠé”è®¡æ•°å™¨+1ï¼Œä¸€æ—¦+1ï¼Œåˆ«çš„çº¿ç¨‹å†æƒ³è·å–ï¼Œå°±éœ€è¦ç­‰å¾…")]),s._v(" "),t("li",[s._v("å¦‚æœè¿™ä¸ªmonitorå·²ç»æ‹¿åˆ°äº†è¿™ä¸ªé”çš„æ‰€æœ‰æƒï¼Œåˆé‡å…¥äº†è¿™æŠŠé”ï¼Œé‚£é”è®¡æ•°å™¨å°±ä¼šç´¯åŠ ï¼Œå˜æˆ2ï¼Œå¹¶ä¸”éšç€é‡å…¥çš„æ¬¡æ•°ï¼Œä¼šä¸€ç›´ç´¯åŠ ")]),s._v(" "),t("li",[s._v("è¿™æŠŠé”å·²ç»è¢«åˆ«çš„çº¿ç¨‹è·å–äº†ï¼Œç­‰å¾…é”é‡Šæ”¾")])]),s._v(" "),t("p",[t("code",[s._v("monitorexitæŒ‡ä»¤")]),s._v("ï¼šé‡Šæ”¾å¯¹äºmonitorçš„æ‰€æœ‰æƒï¼Œé‡Šæ”¾è¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯è®²monitorçš„è®¡æ•°å™¨å‡1ï¼Œå¦‚æœå‡å®Œä»¥åï¼Œè®¡æ•°å™¨ä¸æ˜¯0ï¼Œåˆ™ä»£è¡¨åˆšæ‰æ˜¯é‡å…¥è¿›æ¥çš„ï¼Œå½“å‰çº¿ç¨‹è¿˜ç»§ç»­æŒæœ‰è¿™æŠŠé”çš„æ‰€æœ‰æƒï¼Œå¦‚æœè®¡æ•°å™¨å˜æˆ0ï¼Œåˆ™ä»£è¡¨å½“å‰çº¿ç¨‹ä¸å†æ‹¥æœ‰è¯¥monitorçš„æ‰€æœ‰æƒï¼Œå³é‡Šæ”¾é”ã€‚")]),s._v(" "),t("p",[s._v("ä¸‹å›¾è¡¨ç°äº†å¯¹è±¡ï¼Œå¯¹è±¡ç›‘è§†å™¨ï¼ŒåŒæ­¥é˜Ÿåˆ—ä»¥åŠæ‰§è¡Œçº¿ç¨‹çŠ¶æ€ä¹‹é—´çš„å…³ç³»ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(728),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("è¯¥å›¾å¯ä»¥çœ‹å‡ºï¼Œä»»æ„çº¿ç¨‹å¯¹Objectçš„è®¿é—®ï¼Œé¦–å…ˆè¦è·å¾—Objectçš„ç›‘è§†å™¨ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥åŒæ­¥çŠ¶æ€ï¼Œçº¿ç¨‹çŠ¶æ€å˜ä¸ºBLOCKEDï¼Œå½“Objectçš„ç›‘è§†å™¨å æœ‰è€…é‡Šæ”¾åï¼Œåœ¨åŒæ­¥é˜Ÿåˆ—ä¸­å¾—çº¿ç¨‹å°±ä¼šæœ‰æœºä¼šé‡æ–°è·å–è¯¥ç›‘è§†å™¨ã€‚")]),s._v(" "),t("h3",{attrs:{id:"å¯é‡å…¥åŸç†-åŠ é”æ¬¡æ•°è®¡æ•°å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¯é‡å…¥åŸç†-åŠ é”æ¬¡æ•°è®¡æ•°å™¨"}},[s._v("#")]),s._v(" "),t("strong",[s._v("å¯é‡å…¥åŸç†ï¼šåŠ é”æ¬¡æ•°è®¡æ•°å™¨")])]),s._v(" "),t("p",[s._v("ä¸Šé¢çš„demoä¸­åœ¨æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—"),t("code",[s._v("method1")]),s._v("ä¹‹åç´§æ¥ç€å†ä¼šå»æ‰§è¡Œä¸€ä¸ªé™æ€åŒæ­¥æ–¹æ³•"),t("code",[s._v("method2")]),s._v("ï¼Œè€Œè¿™ä¸ªæ–¹æ³•é”çš„å¯¹è±¡ä¾ç„¶å°±è¿™ä¸ªç±»å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è¿˜éœ€è¦è·å–è¯¥é”å—? ç­”æ¡ˆæ˜¯ä¸å¿…çš„ï¼Œä»ä¸Šå›¾ä¸­å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ‰§è¡Œé™æ€åŒæ­¥æ–¹æ³•çš„æ—¶å€™å°±åªæœ‰ä¸€æ¡monitorexitæŒ‡ä»¤ï¼Œå¹¶æ²¡æœ‰monitorenterè·å–é”çš„æŒ‡ä»¤ã€‚è¿™å°±æ˜¯é”çš„é‡å…¥æ€§ï¼Œå³åœ¨åŒä¸€é”ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¸éœ€è¦å†æ¬¡è·å–åŒä¸€æŠŠé”ã€‚")]),s._v(" "),t("p",[s._v("Synchronizedå…ˆå¤©å…·æœ‰é‡å…¥æ€§ã€‚æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥å¯¹è±¡é”åï¼Œè®¡æ•°å™¨å°±ä¼šåŠ ä¸€ï¼Œé‡Šæ”¾é”åå°±ä¼šå°†è®¡æ•°å™¨å‡ä¸€ã€‚")]),s._v(" "),t("h3",{attrs:{id:"ä¿è¯å¯è§æ€§çš„åŸç†-å†…å­˜æ¨¡å‹å’Œhappens-beforeè§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¿è¯å¯è§æ€§çš„åŸç†-å†…å­˜æ¨¡å‹å’Œhappens-beforeè§„åˆ™"}},[s._v("#")]),s._v(" ä¿è¯å¯è§æ€§çš„åŸç†ï¼šå†…å­˜æ¨¡å‹å’Œhappens-beforeè§„åˆ™")]),s._v(" "),t("p",[s._v("Synchronizedçš„"),t("code",[s._v("happens-before")]),s._v("è§„åˆ™ï¼Œå³ç›‘è§†å™¨é”è§„åˆ™ï¼šå¯¹åŒä¸€ä¸ªç›‘è§†å™¨çš„"),t("strong",[s._v("è§£é”")]),s._v("ï¼Œ"),t("code",[s._v("happens-before")]),t("strong",[s._v("äº")]),s._v("å¯¹è¯¥ç›‘è§†å™¨çš„"),t("strong",[s._v("åŠ é”")]),s._v("ã€‚ç»§ç»­æ¥çœ‹ä»£ç ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MonitorDemo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("writer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1")]),s._v("\n        a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("                                       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("reader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("è¯¥ä»£ç çš„happens-beforeå…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(729),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("åœ¨å›¾ä¸­æ¯ä¸€ä¸ªç®­å¤´è¿æ¥çš„"),t("strong",[s._v("ä¸¤ä¸ªèŠ‚ç‚¹å°±ä»£è¡¨ä¹‹é—´çš„happens-beforeå…³ç³»")]),s._v("ï¼Œ"),t("strong",[s._v("é»‘è‰²çš„æ˜¯é€šè¿‡ç¨‹åºé¡ºåºè§„åˆ™æ¨å¯¼å‡ºæ¥")]),s._v("ï¼Œ"),t("strong",[s._v("çº¢è‰²çš„ä¸ºç›‘è§†å™¨é”è§„åˆ™æ¨å¯¼è€Œå‡º")]),s._v("ï¼š"),t("strong",[s._v("çº¿ç¨‹Aé‡Šæ”¾é”(è§£é”)happens-beforeçº¿ç¨‹BåŠ é”")]),s._v("ï¼Œè“è‰²çš„åˆ™æ˜¯é€šè¿‡ç¨‹åºé¡ºåºè§„åˆ™å’Œç›‘è§†å™¨é”è§„åˆ™æ¨æµ‹å‡ºæ¥happens-beforeå…³ç³»ï¼Œé€šè¿‡ä¼ é€’æ€§è§„åˆ™è¿›ä¸€æ­¥æ¨å¯¼çš„happens-beforeå…³ç³»ã€‚ç°åœ¨æˆ‘ä»¬æ¥é‡ç‚¹å…³æ³¨2 happens-before 5ï¼Œé€šè¿‡è¿™ä¸ªå…³ç³»æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»€ä¹ˆ?")]),s._v(" "),t("p",[s._v("æ ¹æ®happens-beforeçš„å®šä¹‰ä¸­çš„ä¸€æ¡:"),t("strong",[s._v("å¦‚æœA happens-before Bï¼Œåˆ™Açš„æ‰§è¡Œç»“æœå¯¹Bå¯è§ï¼Œå¹¶ä¸”Açš„æ‰§è¡Œé¡ºåºå…ˆäºB")]),s._v("ã€‚çº¿ç¨‹Aå…ˆå¯¹å…±äº«å˜é‡Aè¿›è¡ŒåŠ ä¸€ï¼Œ"),t("strong",[s._v("ç”±2 happens-before 5å…³ç³»å¯çŸ¥çº¿ç¨‹Açš„æ‰§è¡Œç»“æœå¯¹çº¿ç¨‹Bå¯è§å³çº¿ç¨‹Bæ‰€è¯»å–åˆ°çš„açš„å€¼ä¸º1")]),s._v("ã€‚")]),s._v(" "),t("h2",{attrs:{id:"jvmä¸­é”çš„ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jvmä¸­é”çš„ä¼˜åŒ–"}},[s._v("#")]),s._v(" JVMä¸­é”çš„ä¼˜åŒ–")]),s._v(" "),t("p",[s._v("ç®€å•æ¥è¯´åœ¨JVMä¸­monitorenterå’Œmonitorexitå­—èŠ‚ç ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„Mutex Lockæ¥å®ç°çš„ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨Mutex Lockéœ€è¦å°†å½“å‰çº¿ç¨‹æŒ‚èµ·å¹¶ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€æ¥æ‰§è¡Œï¼Œè¿™ç§åˆ‡æ¢çš„ä»£ä»·æ˜¯éå¸¸æ˜‚è´µçš„ï¼›ç„¶è€Œåœ¨ç°å®ä¸­çš„å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒåŒæ­¥æ–¹æ³•æ˜¯è¿è¡Œåœ¨å•çº¿ç¨‹ç¯å¢ƒ(æ— é”ç«äº‰ç¯å¢ƒ)å¦‚æœæ¯æ¬¡éƒ½è°ƒç”¨Mutex Locké‚£ä¹ˆå°†ä¸¥é‡çš„å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚"),t("strong",[s._v("ä¸è¿‡åœ¨jdk1.6ä¸­å¯¹é”çš„å®ç°å¼•å…¥äº†å¤§é‡çš„ä¼˜åŒ–ï¼Œå¦‚é”ç²—åŒ–(Lock Coarsening)ã€é”æ¶ˆé™¤(Lock Elimination)ã€è½»é‡çº§é”(Lightweight Locking)ã€åå‘é”(Biased Locking)ã€é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning)ç­‰æŠ€æœ¯æ¥å‡å°‘é”æ“ä½œçš„å¼€é”€")]),s._v("ã€‚")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("é”ç²—åŒ–(Lock Coarsening)")]),s._v("ï¼šä¹Ÿå°±æ˜¯å‡å°‘ä¸å¿…è¦çš„ç´§è¿åœ¨ä¸€èµ·çš„unlockï¼Œlockæ“ä½œï¼Œå°†å¤šä¸ªè¿ç»­çš„é”"),t("strong",[s._v("æ‰©å±•æˆä¸€ä¸ªèŒƒå›´æ›´å¤§çš„é”")]),s._v("ã€‚")]),s._v(" "),t("li",[t("code",[s._v("é”æ¶ˆé™¤(Lock Elimination)")]),s._v("ï¼šé€šè¿‡è¿è¡Œæ—¶JITç¼–è¯‘å™¨çš„é€ƒé€¸åˆ†ææ¥"),t("strong",[s._v("æ¶ˆé™¤ä¸€äº›æ²¡æœ‰åœ¨å½“å‰åŒæ­¥å—ä»¥å¤–è¢«å…¶ä»–çº¿ç¨‹å…±äº«çš„æ•°æ®çš„é”")]),s._v("ä¿æŠ¤ï¼Œé€šè¿‡é€ƒé€¸åˆ†æä¹Ÿå¯ä»¥åœ¨çº¿ç¨‹æœ¬åœ°Stackä¸Šè¿›è¡Œå¯¹è±¡ç©ºé—´çš„åˆ†é…(åŒæ—¶è¿˜å¯ä»¥å‡å°‘Heapä¸Šçš„åƒåœ¾æ”¶é›†å¼€é”€)ã€‚")]),s._v(" "),t("li",[t("code",[s._v("è½»é‡çº§é”(Lightweight Locking)")]),s._v("ï¼šè¿™ç§é”å®ç°çš„èƒŒå"),t("strong",[s._v("åŸºäºè¿™æ ·ä¸€ç§å‡è®¾")]),s._v("ï¼Œå³åœ¨çœŸå®çš„æƒ…å†µä¸‹æˆ‘ä»¬ç¨‹åºä¸­çš„"),t("strong",[s._v("å¤§éƒ¨åˆ†åŒæ­¥ä»£ç ä¸€èˆ¬éƒ½å¤„äºæ— é”ç«äº‰çŠ¶æ€")]),s._v("(å³å•çº¿ç¨‹æ‰§è¡Œç¯å¢ƒ)ï¼Œ"),t("strong",[s._v("åœ¨æ— é”ç«äº‰çš„æƒ…å†µä¸‹å®Œå…¨å¯ä»¥é¿å…è°ƒç”¨æ“ä½œç³»ç»Ÿå±‚é¢çš„é‡é‡çº§äº’æ–¥é”")]),s._v("ï¼Œ"),t("strong",[s._v("å–è€Œä»£ä¹‹")]),s._v("çš„"),t("strong",[s._v("æ˜¯åœ¨monitorenterå’Œmonitorexitä¸­åªéœ€è¦ä¾é ä¸€æ¡CASåŸå­æŒ‡ä»¤å°±å¯ä»¥å®Œæˆé”çš„è·å–åŠé‡Šæ”¾")]),s._v("ã€‚å½“"),t("strong",[s._v("å­˜åœ¨é”ç«äº‰çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡ŒCASæŒ‡ä»¤å¤±è´¥çš„çº¿ç¨‹å°†è°ƒç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é”")]),s._v("è¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œå½“"),t("strong",[s._v("é”è¢«é‡Šæ”¾çš„æ—¶å€™è¢«å”¤é†’")]),s._v("(å…·ä½“å¤„ç†æ­¥éª¤ä¸‹é¢è¯¦ç»†è®¨è®º)ã€‚")]),s._v(" "),t("li",[t("code",[s._v("åå‘é”(Biased Locking)")]),s._v("ï¼šæ˜¯ä¸ºäº†åœ¨æ— é”ç«äº‰çš„æƒ…å†µä¸‹"),t("strong",[s._v("é¿å…åœ¨é”è·å–è¿‡ç¨‹ä¸­æ‰§è¡Œä¸å¿…è¦çš„CASåŸå­æŒ‡ä»¤")]),s._v("ï¼Œå› ä¸º"),t("strong",[s._v("CASåŸå­æŒ‡ä»¤")]),s._v("è™½ç„¶ç›¸å¯¹äºé‡é‡çº§é”æ¥è¯´å¼€é”€æ¯”è¾ƒå°"),t("strong",[s._v("ä½†è¿˜æ˜¯å­˜åœ¨éå¸¸å¯è§‚çš„æœ¬åœ°å»¶è¿Ÿ")]),s._v("ã€‚")]),s._v(" "),t("li",[t("code",[s._v("é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning)")]),s._v("ï¼šå½“çº¿ç¨‹åœ¨"),t("strong",[s._v("è·å–è½»é‡çº§é”çš„è¿‡ç¨‹ä¸­æ‰§è¡ŒCASæ“ä½œå¤±è´¥æ—¶")]),s._v("ï¼Œåœ¨"),t("strong",[s._v("è¿›å…¥")]),s._v("ä¸monitorç›¸å…³è”çš„"),t("strong",[s._v("æ“ä½œç³»ç»Ÿé‡é‡çº§é”")]),s._v("(mutex semaphore)"),t("strong",[s._v("å‰ä¼šè¿›å…¥å¿™ç­‰å¾…")]),s._v("(Spinning)ç„¶å"),t("strong",[s._v("å†æ¬¡å°è¯•")]),s._v("ï¼Œå½“"),t("strong",[s._v("å°è¯•ä¸€å®šçš„æ¬¡æ•°åå¦‚æœä»ç„¶æ²¡æœ‰æˆåŠŸåˆ™è°ƒç”¨ä¸è¯¥monitorå…³è”çš„semaphore(å³äº’æ–¥é”)è¿›å…¥åˆ°é˜»å¡çŠ¶æ€")]),s._v("ã€‚")])]),s._v(" "),t("blockquote",[t("p",[s._v("ä¸‹é¢æ¥è¯¦ç»†è®²è§£ä¸‹ï¼Œå…ˆä»SynchroniedåŒæ­¥é”å¼€å§‹è®²èµ·ï¼š")])]),s._v(" "),t("h3",{attrs:{id:"é”çš„ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é”çš„ç±»å‹"}},[s._v("#")]),s._v(" "),t("strong",[s._v("é”çš„ç±»å‹")])]),s._v(" "),t("p",[s._v("åœ¨Java SE 1.6é‡ŒSynchroniedåŒæ­¥é”ï¼Œä¸€å…±æœ‰å››ç§çŠ¶æ€ï¼š"),t("code",[s._v("æ— é”")]),s._v("ã€"),t("code",[s._v("åå‘é”")]),s._v("ã€"),t("code",[s._v("è½»é‡çº§æ‰€")]),s._v("ã€"),t("code",[s._v("é‡é‡çº§é”")]),s._v("ï¼Œå®ƒä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ã€‚é”å¯ä»¥å‡çº§ä½†æ˜¯ä¸å¯ä»¥é™çº§ï¼Œç›®çš„æ˜¯ä¸ºäº†æä¾›è·å–é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡ã€‚")]),s._v(" "),t("blockquote",[t("p",[s._v("é”è†¨èƒ€æ–¹å‘ï¼š æ— é” â†’ åå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é” (æ­¤è¿‡ç¨‹æ˜¯ä¸å¯é€†çš„)")])]),s._v(" "),t("h3",{attrs:{id:"è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹é”"}},[s._v("#")]),s._v(" è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹é”")]),s._v(" "),t("p",[t("strong",[s._v("è‡ªæ—‹é”")])]),s._v(" "),t("blockquote",[t("p",[s._v("å¼•å…¥èƒŒæ™¯ï¼šå¤§å®¶éƒ½çŸ¥é“ï¼Œåœ¨æ²¡æœ‰åŠ å…¥é”ä¼˜åŒ–æ—¶ï¼ŒSynchronizedæ˜¯ä¸€ä¸ªéå¸¸â€œèƒ–å¤§â€çš„å®¶ä¼™ã€‚åœ¨å¤šçº¿ç¨‹ç«äº‰é”æ—¶ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å–é”æ—¶ï¼Œå®ƒä¼šé˜»å¡æ‰€æœ‰æ­£åœ¨ç«äº‰çš„çº¿ç¨‹ï¼Œè¿™æ ·å¯¹æ€§èƒ½å¸¦æ¥äº†æå¤§çš„å½±å“ã€‚åœ¨æŒ‚èµ·çº¿ç¨‹å’Œæ¢å¤çº¿ç¨‹çš„æ“ä½œéƒ½éœ€è¦è½¬å…¥å†…æ ¸æ€ä¸­å®Œæˆï¼Œè¿™äº›æ“ä½œå¯¹ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›ã€‚åŒæ—¶HotSpotå›¢é˜Ÿæ³¨æ„åˆ°åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†è¿™æ®µæ—¶é—´å»æŒ‚èµ·å’Œå›å¤é˜»å¡çº¿ç¨‹å¹¶ä¸å€¼å¾—ã€‚åœ¨å¦‚ä»Šå¤šå¤„ç†å™¨ç¯å¢ƒä¸‹ï¼Œå®Œå…¨å¯ä»¥è®©å¦ä¸€ä¸ªæ²¡æœ‰è·å–åˆ°é”çš„çº¿ç¨‹åœ¨é—¨å¤–ç­‰å¾…ä¸€ä¼š(è‡ªæ—‹)ï¼Œä½†ä¸æ”¾å¼ƒCPUçš„æ‰§è¡Œæ—¶é—´ã€‚ç­‰å¾…æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ã€‚ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œæˆ‘ä»¬åªéœ€è¦è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯(è‡ªæ—‹)ï¼Œè¿™ä¾¿æ˜¯è‡ªæ—‹é”ç”±æ¥çš„åŸå› ã€‚")])]),s._v(" "),t("p",[s._v("è‡ªæ—‹é”æ—©åœ¨JDK1.4 ä¸­å°±å¼•å…¥äº†ï¼Œåªæ˜¯å½“æ—¶é»˜è®¤æ—¶å…³é—­çš„ã€‚åœ¨JDK 1.6åé»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ã€‚è‡ªæ—‹é”æœ¬è´¨ä¸Šä¸é˜»å¡å¹¶ä¸ç›¸åŒï¼Œå…ˆä¸è€ƒè™‘å…¶å¯¹å¤šå¤„ç†å™¨çš„è¦æ±‚ï¼Œå¦‚æœé”å ç”¨çš„æ—¶é—´éå¸¸çš„çŸ­ï¼Œé‚£ä¹ˆè‡ªæ—‹é”çš„æ€§èƒ½ä¼šéå¸¸çš„å¥½ï¼Œç›¸åï¼Œå…¶ä¼šå¸¦æ¥æ›´å¤šçš„æ€§èƒ½å¼€é”€(å› ä¸ºåœ¨çº¿ç¨‹è‡ªæ—‹æ—¶ï¼Œå§‹ç»ˆä¼šå ç”¨CPUçš„æ—¶é—´ç‰‡ï¼Œå¦‚æœé”å ç”¨çš„æ—¶é—´å¤ªé•¿ï¼Œé‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹ä¼šç™½ç™½æ¶ˆè€—æ‰CPUèµ„æº)ã€‚å› æ­¤è‡ªæ—‹ç­‰å¾…çš„æ—¶é—´å¿…é¡»è¦æœ‰ä¸€å®šçš„é™åº¦ï¼Œå¦‚æœ"),t("strong",[s._v("è‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å–åˆ°é”ï¼Œå°±åº”è¯¥ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹")]),s._v("äº†ï¼Œåœ¨JDKå®šä¹‰ä¸­ï¼Œ"),t("strong",[s._v("è‡ªæ—‹é”é»˜è®¤çš„è‡ªæ—‹æ¬¡æ•°ä¸º10æ¬¡ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å‚æ•°"),t("code",[s._v("-XX:PreBlockSpin")]),s._v("æ¥æ›´æ”¹")]),s._v("ã€‚")]),s._v(" "),t("p",[s._v("å¯æ˜¯ç°åœ¨åˆå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼š"),t("strong",[s._v("å¦‚æœçº¿ç¨‹é”åœ¨çº¿ç¨‹è‡ªæ—‹åˆšç»“æŸå°±é‡Šæ”¾æ‰äº†é”ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰ç‚¹å¾—ä¸å¿å¤±")]),s._v("ã€‚æ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬"),t("strong",[s._v("éœ€è¦æ›´åŠ èªæ˜çš„é”")]),s._v("æ¥å®ç°æ›´åŠ çµæ´»çš„è‡ªæ—‹ã€‚æ¥æé«˜å¹¶å‘çš„æ€§èƒ½ã€‚(è¿™é‡Œåˆ™éœ€è¦è‡ªé€‚åº”è‡ªæ—‹é”ï¼)")]),s._v(" "),t("p",[t("strong",[s._v("è‡ªé€‚åº”è‡ªæ—‹é”")])]),s._v(" "),t("p",[s._v("åœ¨JDK 1.6ä¸­å¼•å…¥äº†è‡ªé€‚åº”è‡ªæ—‹é”ã€‚è¿™å°±æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹ æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šçš„ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œè‡ªæ—‹ç­‰å¾…åˆšåˆšæˆåŠŸè·å–è¿‡é”ï¼Œå¹¶ä¸”æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ï¼Œé‚£ä¹ˆJVMä¼šè®¤ä¸ºè¯¥é”è‡ªæ—‹è·å–åˆ°é”çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œä¼šè‡ªåŠ¨å¢åŠ ç­‰å¾…æ—¶é—´ã€‚æ¯”å¦‚å¢åŠ åˆ°100æ­¤å¾ªç¯ã€‚ç›¸åï¼Œå¦‚æœå¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å–é”ã€‚é‚£å†ä»¥åè¦è·å–è¿™ä¸ªé”æ—¶å°†å¯èƒ½çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œä»¥é¿å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚æœ‰äº†è‡ªé€‚åº”è‡ªæ—‹ï¼ŒJVMå¯¹ç¨‹åºçš„é”çš„çŠ¶æ€é¢„æµ‹ä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼ŒJVMä¹Ÿä¼šè¶Šæ¥è¶Šèªæ˜ã€‚")]),s._v(" "),t("h3",{attrs:{id:"é”æ¶ˆé™¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é”æ¶ˆé™¤"}},[s._v("#")]),s._v(" é”æ¶ˆé™¤")]),s._v(" "),t("p",[s._v("é”æ¶ˆé™¤æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨å†è¿è¡Œæ—¶ï¼Œå¯¹ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤å®šä¾æ®æ¥æºäºé€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒã€‚æ„æ€å°±æ˜¯ï¼šJVMä¼šåˆ¤æ–­å†ä¸€æ®µç¨‹åºä¸­çš„åŒæ­¥æ˜æ˜¾ä¸ä¼šé€ƒé€¸å‡ºå»ä»è€Œè¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£JVMå°±æŠŠå®ƒä»¬å½“ä½œæ ˆä¸Šæ•°æ®å¯¹å¾…ï¼Œè®¤ä¸ºè¿™äº›æ•°æ®æ—¶çº¿ç¨‹ç‹¬æœ‰çš„ï¼Œä¸éœ€è¦åŠ åŒæ­¥ã€‚æ­¤æ—¶å°±ä¼šè¿›è¡Œé”æ¶ˆé™¤ã€‚")]),s._v(" "),t("p",[s._v("å½“ç„¶åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šçš„çŸ¥é“é‚£äº›åœ°æ–¹æ—¶çº¿ç¨‹ç‹¬æœ‰çš„ï¼Œä¸éœ€è¦åŠ åŒæ­¥é”ï¼Œä½†æ˜¯åœ¨Java APIä¸­æœ‰å¾ˆå¤šæ–¹æ³•éƒ½æ˜¯åŠ äº†åŒæ­¥çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶JVMä¼šåˆ¤æ–­è¿™æ®µä»£ç æ˜¯å¦éœ€è¦åŠ é”ã€‚å¦‚æœæ•°æ®å¹¶ä¸ä¼šé€ƒé€¸ï¼Œåˆ™ä¼šè¿›è¡Œé”æ¶ˆé™¤ã€‚æ¯”å¦‚å¦‚ä¸‹æ“ä½œï¼šåœ¨æ“ä½œStringç±»å‹æ•°æ®æ—¶ï¼Œç”±äºStringæ˜¯ä¸€ä¸ªä¸å¯å˜ç±»ï¼Œå¯¹å­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œæ€»æ˜¯é€šè¿‡ç”Ÿæˆçš„æ–°çš„Stringå¯¹è±¡æ¥è¿›è¡Œçš„ã€‚å› æ­¤Javacç¼–è¯‘å™¨ä¼šå¯¹Stringè¿æ¥åšè‡ªåŠ¨ä¼˜åŒ–ã€‚åœ¨JDK 1.5ä¹‹å‰ä¼šä½¿ç”¨StringBufferå¯¹è±¡çš„è¿ç»­append()æ“ä½œï¼Œåœ¨JDK 1.5åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œä¼šè½¬åŒ–ä¸ºStringBuidlerå¯¹è±¡çš„è¿ç»­append()æ“ä½œã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("test03")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" s1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" s2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("ä¸Šè¿°ä»£ç ä½¿ç”¨javapç¼–è¯‘ç»“æœï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(730),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("ä¼—æ‰€å‘¨çŸ¥ï¼ŒStringBuilderä¸æ˜¯å®‰å…¨åŒæ­¥çš„ï¼Œä½†æ˜¯åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒJVMåˆ¤æ–­è¯¥æ®µä»£ç å¹¶ä¸ä¼šé€ƒé€¸ï¼Œåˆ™å°†è¯¥ä»£ç å¸¦é»˜è®¤ä¸ºçº¿ç¨‹ç‹¬æœ‰çš„èµ„æºï¼Œå¹¶ä¸éœ€è¦åŒæ­¥ï¼Œæ‰€ä»¥æ‰§è¡Œäº†é”æ¶ˆé™¤æ“ä½œã€‚(è¿˜æœ‰Vectorä¸­çš„å„ç§æ“ä½œä¹Ÿå¯å®ç°é”æ¶ˆé™¤ã€‚åœ¨æ²¡æœ‰é€ƒé€¸å‡ºæ•°æ®å®‰å…¨é˜²å«å†…)")]),s._v(" "),t("h3",{attrs:{id:"é”ç²—åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é”ç²—åŒ–"}},[s._v("#")]),s._v(" é”ç²—åŒ–")]),s._v(" "),t("p",[s._v("åŸåˆ™ä¸Šï¼Œæˆ‘ä»¬éƒ½çŸ¥é“"),t("strong",[s._v("åœ¨åŠ åŒæ­¥é”æ—¶ï¼Œå°½å¯èƒ½çš„å°†åŒæ­¥å—çš„ä½œç”¨èŒƒå›´é™åˆ¶åˆ°å°½é‡å°çš„èŒƒå›´")]),s._v("(åª"),t("strong",[s._v("åœ¨å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸä¸­æ‰è¿›è¡ŒåŒæ­¥")]),s._v("ï¼Œè¿™æ ·æ˜¯ä¸ºäº†"),t("strong",[s._v("ä½¿å¾—éœ€è¦åŒæ­¥çš„æ“ä½œæ•°é‡å°½å¯èƒ½å˜å°")]),s._v("ã€‚åœ¨å­˜åœ¨é”åŒæ­¥ç«äº‰ä¸­ï¼Œä¹Ÿå¯ä»¥"),t("strong",[s._v("ä½¿å¾—ç­‰å¾…é”çš„çº¿ç¨‹å°½æ—©çš„æ‹¿åˆ°é”")]),s._v(")ã€‚")]),s._v(" "),t("p",[s._v("å¤§éƒ¨åˆ†ä¸Šè¿°æƒ…å†µæ˜¯å®Œç¾æ­£ç¡®çš„ï¼Œä½†æ˜¯"),t("strong",[s._v("å¦‚æœå­˜åœ¨è¿ä¸²çš„ä¸€ç³»åˆ—æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”")]),s._v("ï¼Œ"),t("strong",[s._v("ç”šè‡³åŠ é”æ“ä½œæ—¶å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„")]),s._v("ï¼Œé‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦åœ°æ€§èƒ½æ“ä½œã€‚")]),s._v(" "),t("p",[s._v("è¿™é‡Œè´´ä¸Šæ ¹æ®ä¸Šè¿°Javap ç¼–è¯‘åœ°æƒ…å†µç¼–å†™åœ°å®ä¾‹javaç±»")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("public static String test04(String s1, String s2, String s3) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(s1);\n    sb.append(s2);\n    sb.append(s3);\n    return sb.toString();\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("åœ¨ä¸Šè¿°åœ°"),t("strong",[s._v("è¿ç»­append()æ“ä½œä¸­å°±å±äºè¿™ç±»æƒ…å†µ")]),s._v("ã€‚JVMä¼šæ£€æµ‹åˆ°è¿™æ ·ä¸€è¿ä¸²åœ°æ“ä½œéƒ½æ˜¯å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œé‚£ä¹ˆ"),t("strong",[s._v("JVMä¼šå°†åŠ é”åŒæ­¥åœ°èŒƒå›´æ‰©å±•(ç²—åŒ–)åˆ°æ•´ä¸ªä¸€ç³»åˆ—æ“ä½œçš„å¤–éƒ¨")]),s._v("ï¼Œä½¿æ•´ä¸ªä¸€è¿ä¸²åœ°append()æ“ä½œ"),t("strong",[s._v("åªéœ€è¦åŠ é”ä¸€æ¬¡")]),s._v("å°±å¯ä»¥äº†ã€‚")]),s._v(" "),t("h3",{attrs:{id:"è½»é‡çº§é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è½»é‡çº§é”"}},[s._v("#")]),s._v(" è½»é‡çº§é”")]),s._v(" "),t("p",[s._v("åœ¨JDK 1.6ä¹‹åå¼•å…¥çš„è½»é‡çº§é”ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è½»é‡çº§é”å¹¶ä¸æ˜¯æ›¿ä»£é‡é‡çº§é”çš„ï¼Œè€Œæ˜¯å¯¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åŒæ­¥å—å¹¶ä¸ä¼šæœ‰ç«äº‰å‡ºç°æå‡ºçš„ä¸€ç§ä¼˜åŒ–ã€‚å®ƒå¯ä»¥å‡å°‘é‡é‡çº§é”å¯¹çº¿ç¨‹çš„é˜»å¡å¸¦æ¥åœ°çº¿ç¨‹å¼€é”€ã€‚ä»è€Œæé«˜å¹¶å‘æ€§èƒ½ã€‚")]),s._v(" "),t("p",[s._v("å¦‚æœè¦ç†è§£è½»é‡çº§é”ï¼Œé‚£ä¹ˆå¿…é¡»å…ˆè¦äº†è§£HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡å¤´åœ°å†…å­˜å¸ƒå±€ã€‚ä¸Šé¢ä»‹ç»Javaå¯¹è±¡å¤´ä¹Ÿè¯¦ç»†ä»‹ç»è¿‡ã€‚åœ¨å¯¹è±¡å¤´ä¸­("),t("code",[s._v("Object Header")]),s._v(")å­˜åœ¨ä¸¤éƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼Œ"),t("code",[s._v("HashCode")]),s._v("ã€"),t("code",[s._v("GC Age")]),s._v("ã€"),t("code",[s._v("é”æ ‡è®°ä½")]),s._v("ã€"),t("code",[s._v("æ˜¯å¦ä¸ºåå‘é”")]),s._v("ã€‚ç­‰ã€‚ä¸€èˆ¬ä¸º32ä½æˆ–è€…64ä½(è§†æ“ä½œç³»ç»Ÿä½æ•°å®š)ã€‚å®˜æ–¹ç§°ä¹‹ä¸º"),t("code",[s._v("Mark Word")]),s._v("ï¼Œå®ƒæ˜¯å®ç°è½»é‡çº§é”å’Œåå‘é”çš„å…³é”®ã€‚ å¦å¤–ä¸€éƒ¨åˆ†å­˜å‚¨çš„æ˜¯æŒ‡å‘æ–¹æ³•åŒºå¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆ("),t("code",[s._v("Klass Point")]),s._v(")ï¼Œå¦‚æœå¯¹è±¡æ˜¯æ•°ç»„çš„è¯ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„éƒ¨åˆ†ç”¨äºå­˜å‚¨æ•°æ®çš„é•¿åº¦ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("è½»é‡çº§é”åŠ é”")])]),s._v(" "),t("p",[s._v("åœ¨çº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—ä¹‹å‰ï¼ŒJVMä¼šå…ˆåœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºé”è®°å½•("),t("code",[s._v("Lock Record")]),s._v(")çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„"),t("code",[s._v("Mark Word")]),s._v("çš„æ‹·è´ï¼ˆJVMä¼šå°†å¯¹è±¡å¤´ä¸­çš„"),t("code",[s._v("Mark Word")]),s._v("æ‹·è´åˆ°é”è®°å½•ä¸­ï¼Œå®˜æ–¹ç§°ä¸º"),t("code",[s._v("Displaced Mark Ward")]),s._v("ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çš„çŠ¶æ€å¦‚å›¾ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(731),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("å¦‚ä¸Šå›¾æ‰€ç¤ºï¼šå¦‚æœå½“å‰å¯¹è±¡"),t("strong",[s._v("æ²¡æœ‰è¢«é”å®š")]),s._v("ï¼Œé‚£ä¹ˆé”æ ‡å¿—ä½ä½"),t("strong",[s._v("01")]),s._v("çŠ¶æ€ï¼ŒJVMåœ¨æ‰§è¡Œå½“å‰çº¿ç¨‹æ—¶ï¼Œé¦–å…ˆä¼šåœ¨å½“å‰çº¿ç¨‹æ ˆå¸§ä¸­"),t("strong",[s._v("åˆ›å»ºé”è®°å½•"),t("code",[s._v("Lock Record")]),s._v("çš„ç©ºé—´ç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„"),t("code",[s._v("Mark Word")]),s._v("çš„æ‹·è´")]),s._v("ã€‚")]),s._v(" "),t("p",[s._v("ç„¶åï¼Œè™šæ‹Ÿæœº"),t("strong",[s._v("ä½¿ç”¨CASæ“ä½œå°†æ ‡è®°å­—æ®µMark Wordæ‹·è´åˆ°é”è®°å½•ä¸­")]),s._v("ï¼Œå¹¶ä¸”"),t("strong",[s._v("å°†"),t("code",[s._v("Mark Word")]),s._v("æ›´æ–°ä¸ºæŒ‡å‘"),t("code",[s._v("Lock Record")]),s._v("çš„æŒ‡é’ˆ")]),s._v("ã€‚å¦‚æœæ›´æ–°"),t("strong",[s._v("æˆåŠŸäº†")]),s._v("ï¼Œé‚£ä¹ˆè¿™ä¸ª"),t("strong",[s._v("çº¿ç¨‹å°±æœ‰ç”¨äº†è¯¥å¯¹è±¡çš„é”")]),s._v("ï¼Œå¹¶ä¸”å¯¹è±¡"),t("strong",[s._v("Mark Wordçš„é”æ ‡å¿—ä½æ›´æ–°ä¸º")]),s._v("("),t("code",[s._v("Mark Word")]),s._v("ä¸­æœ€åçš„2bit) "),t("strong",[s._v("00")]),s._v("ï¼Œå³"),t("strong",[s._v("è¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€")]),s._v("ï¼Œå¦‚å›¾ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(732),alt:"Untitled"}})]),s._v(" "),t("p",[s._v("å¦‚æœè¿™ä¸ªæ›´æ–°æ“ä½œå¤±è´¥ï¼ŒJVMä¼šæ£€æŸ¥å½“å‰çš„"),t("code",[s._v("**Mark Word")]),s._v("ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§çš„æŒ‡é’ˆï¼Œå¦‚æœæœ‰ï¼Œè¯´æ˜è¯¥é”å·²ç»è¢«è·å–**ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚å¦‚æœ"),t("strong",[s._v("æ²¡æœ‰ï¼Œåˆ™è¯´æ˜è¯¥é”è¢«å…¶ä»–çº¿ç¨‹æŠ¢å ")]),s._v("äº†ï¼Œå¦‚æœæœ‰"),t("strong",[s._v("ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹ç«äº‰åŒä¸€ä¸ªé”ï¼Œé‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆï¼Œç›´æ¥è†¨èƒ€ä¸ºé‡é‡çº§é”")]),s._v("ï¼Œæ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚æ­¤æ—¶ï¼Œé”çš„æ ‡å¿—ä½ä¸º"),t("code",[s._v("10")]),s._v("ï¼Œ"),t("code",[s._v("Mark Word")]),s._v("ä¸­å­˜å‚¨çš„æ˜¯æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆã€‚")]),s._v(" "),t("p",[s._v("è½»é‡çº§"),t("strong",[s._v("è§£é”æ—¶")]),s._v("ï¼Œä¼š"),t("strong",[s._v("ä½¿ç”¨åŸå­çš„CASæ“ä½œå°†"),t("code",[s._v("Displaced Mark Word")]),s._v("æ›¿æ¢å›åˆ°å¯¹è±¡å¤´")]),s._v("ä¸­ï¼Œå¦‚æœ"),t("strong",[s._v("æˆåŠŸï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰å‘ç”Ÿç«äº‰å…³ç³»")]),s._v("ã€‚å¦‚æœ"),t("strong",[s._v("å¤±è´¥ï¼Œè¡¨ç¤ºå½“å‰é”å­˜åœ¨ç«äº‰å…³ç³»")]),s._v("ã€‚é”å°±ä¼š"),t("strong",[s._v("è†¨èƒ€æˆé‡é‡çº§é”")]),s._v("ã€‚ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶äº‰å¤ºé”ï¼Œå¯¼è‡´é”è†¨èƒ€çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(733),alt:"Untitled"}})]),s._v(" "),t("h3",{attrs:{id:"åå‘é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åå‘é”"}},[s._v("#")]),s._v(" åå‘é”")]),s._v(" "),t("blockquote",[t("p",[s._v("å¼•å…¥èƒŒæ™¯ï¼šåœ¨å¤§å¤šå®é™…ç¯å¢ƒä¸‹ï¼Œé”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œè€Œä¸”æ€»æ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–ï¼Œé‚£ä¹ˆåœ¨åŒä¸€ä¸ªçº¿ç¨‹åå¤è·å–æ‰€é‡Šæ”¾é”ä¸­ï¼Œå…¶ä¸­å¹¶è¿˜æ²¡æœ‰é”çš„ç«äº‰ï¼Œé‚£ä¹ˆè¿™æ ·çœ‹ä¸Šå»ï¼Œå¤šæ¬¡çš„è·å–é”å’Œé‡Šæ”¾é”å¸¦æ¥äº†å¾ˆå¤šä¸å¿…è¦çš„æ€§èƒ½å¼€é”€å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚")])]),s._v(" "),t("p",[s._v("ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒHotSpotçš„ä½œè€…åœ¨Java SE 1.6 ä¸­å¯¹Synchronizedè¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¼•å…¥äº†åå‘é”ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å¿«å¹¶è·å–é”æ—¶ï¼Œä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§ä¸­çš„é”è®°å½•é‡Œå­˜å‚¨é”åå‘çš„çº¿ç¨‹IDï¼Œä»¥åè¯¥çº¿ç¨‹åœ¨è¿›å…¥å’Œæ¨å‡ºåŒæ­¥å—æ—¶ä¸éœ€è¦è¿›è¡ŒCASæ“ä½œæ¥åŠ é”å’Œè§£é”ã€‚åªéœ€è¦ç®€å•åœ°æµ‹è¯•ä¸€ä¸‹å¯¹è±¡å¤´çš„"),t("code",[s._v("Mark Word")]),s._v("é‡Œæ˜¯å¦å­˜å‚¨ç€æŒ‡å‘å½“å‰çº¿ç¨‹çš„åå‘é”ã€‚å¦‚æœæˆåŠŸï¼Œè¡¨ç¤ºçº¿ç¨‹å·²ç»è·å–åˆ°äº†é”ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:a(734),alt:"Untitled"}})]),s._v(" "),t("p",[t("strong",[s._v("åå‘é”çš„æ’¤é”€")])]),s._v(" "),t("p",[s._v("åå‘é”ä½¿ç”¨äº†ä¸€ç§ç­‰å¾…ç«äº‰å‡ºç°æ‰ä¼šé‡Šæ”¾é”çš„æœºåˆ¶ã€‚æ‰€ä»¥å½“å…¶ä»–çº¿ç¨‹å°è¯•è·å–åå‘é”æ—¶ï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ã€‚ä½†æ˜¯åå‘é”çš„æ’¤é”€éœ€è¦ç­‰åˆ°å…¨å±€å®‰å…¨ç‚¹(å°±æ˜¯å½“å‰çº¿ç¨‹æ²¡æœ‰æ­£åœ¨æ‰§è¡Œçš„å­—èŠ‚ç )ã€‚å®ƒä¼šé¦–å…ˆæš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹ï¼Œè®©ä½ åæ£€æŸ¥æŒæœ‰åå‘é”çš„çº¿ç¨‹æ˜¯å¦æ´»ç€ã€‚å¦‚æœçº¿ç¨‹ä¸å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œç›´æ¥å°†å¯¹è±¡å¤´è®¾ç½®ä¸ºæ— é”çŠ¶æ€ã€‚å¦‚æœçº¿ç¨‹æ´»ç€ï¼ŒJVMä¼šéå†æ ˆå¸§ä¸­çš„é”è®°å½•ï¼Œæ ˆå¸§ä¸­çš„é”è®°å½•å’Œå¯¹è±¡å¤´è¦ä¹ˆåå‘äºå…¶ä»–çº¿ç¨‹ï¼Œè¦ä¹ˆæ¢å¤åˆ°æ— é”çŠ¶æ€æˆ–è€…æ ‡è®°å¯¹è±¡ä¸é€‚åˆä½œä¸ºåå‘é”ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:a(735),alt:"Untitled"}})]),s._v(" "),t("h3",{attrs:{id:"é”çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é”çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”"}},[s._v("#")]),s._v(" é”çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.notion.so/fdd75b3f1c524aadbc4059e3edf9a30d",target:"_blank",rel:"noopener noreferrer"}},[s._v("Untitled"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"synchronizedä¸lock"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#synchronizedä¸lock"}},[s._v("#")]),s._v(" Synchronizedä¸Lock")]),s._v(" "),t("h3",{attrs:{id:"synchronizedçš„ç¼ºé™·"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#synchronizedçš„ç¼ºé™·"}},[s._v("#")]),s._v(" synchronizedçš„ç¼ºé™·")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("æ•ˆç‡ä½")]),s._v("ï¼šé”çš„é‡Šæ”¾æƒ…å†µå°‘ï¼Œåªæœ‰ä»£ç æ‰§è¡Œå®Œæ¯•æˆ–è€…å¼‚å¸¸ç»“æŸæ‰ä¼šé‡Šæ”¾é”ï¼›è¯•å›¾è·å–é”çš„æ—¶å€™ä¸èƒ½è®¾å®šè¶…æ—¶ï¼Œä¸èƒ½ä¸­æ–­ä¸€ä¸ªæ­£åœ¨ä½¿ç”¨é”çš„çº¿ç¨‹ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒLockå¯ä»¥ä¸­æ–­å’Œè®¾ç½®è¶…æ—¶")]),s._v(" "),t("li",[t("code",[s._v("ä¸å¤Ÿçµæ´»")]),s._v("ï¼šåŠ é”å’Œé‡Šæ”¾çš„æ—¶æœºå•ä¸€ï¼Œæ¯ä¸ªé”ä»…æœ‰ä¸€ä¸ªå•ä¸€çš„æ¡ä»¶(æŸä¸ªå¯¹è±¡)ï¼Œç›¸å¯¹è€Œè¨€ï¼Œè¯»å†™é”æ›´åŠ çµæ´»")]),s._v(" "),t("li",[t("code",[s._v("æ— æ³•çŸ¥é“æ˜¯å¦æˆåŠŸè·å¾—é”")]),s._v("ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒLockå¯ä»¥æ‹¿åˆ°çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸè·å–é”ï¼Œ....ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œ.....")])]),s._v(" "),t("h3",{attrs:{id:"lockè§£å†³ç›¸åº”é—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lockè§£å†³ç›¸åº”é—®é¢˜"}},[s._v("#")]),s._v(" Lockè§£å†³ç›¸åº”é—®é¢˜")]),s._v(" "),t("p",[s._v("Lockç±»è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä¸»è¦çœ‹é‡Œé¢çš„4ä¸ªæ–¹æ³•:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("lock()")]),s._v(": åŠ é”")]),s._v(" "),t("li",[t("code",[s._v("unlock()")]),s._v(": è§£é”")]),s._v(" "),t("li",[t("code",[s._v("tryLock()")]),s._v(": å°è¯•è·å–é”ï¼Œè¿”å›ä¸€ä¸ªbooleanå€¼")]),s._v(" "),t("li",[t("code",[s._v("tryLock(long,TimeUtil)")]),s._v(": å°è¯•è·å–é”ï¼Œå¯ä»¥è®¾ç½®è¶…æ—¶")])]),s._v(" "),t("p",[s._v("Synchronizedåªæœ‰é”åªä¸ä¸€ä¸ªæ¡ä»¶(æ˜¯å¦è·å–é”)ç›¸å…³è”ï¼Œä¸çµæ´»ï¼Œåæ¥"),t("code",[s._v("Conditionä¸Lockçš„ç»“åˆ")]),s._v("è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("å¤šçº¿ç¨‹ç«äº‰ä¸€ä¸ªé”æ—¶ï¼Œå…¶ä½™æœªå¾—åˆ°é”çš„çº¿ç¨‹åªèƒ½ä¸åœçš„å°è¯•è·å¾—é”ï¼Œè€Œä¸èƒ½ä¸­æ–­ã€‚é«˜å¹¶å‘çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™")]),s._v("ã€‚ReentrantLockçš„lockInterruptibly()æ–¹æ³•å¯ä»¥ä¼˜å…ˆè€ƒè™‘å“åº”ä¸­æ–­ã€‚ ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œå®ƒå¯ä»¥ä¸­æ–­è‡ªå·±ï¼Œç„¶åReentrantLockå“åº”è¿™ä¸ªä¸­æ–­ï¼Œä¸å†è®©è¿™ä¸ªçº¿ç¨‹ç»§ç»­ç­‰å¾…ã€‚æœ‰äº†è¿™ä¸ªæœºåˆ¶ï¼Œä½¿ç”¨ReentrantLockæ—¶å°±ä¸ä¼šåƒsynchronizedé‚£æ ·äº§ç”Ÿæ­»é”äº†ã€‚")]),s._v(" "),t("blockquote",[t("p",[t("code",[s._v("ReentrantLock")]),s._v("ä¸ºå¸¸ç”¨ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ª"),t("strong",[s._v("å¯é‡å…¥çš„äº’æ–¥é” Lock")]),s._v("ï¼Œå®ƒå…·æœ‰ä¸ä½¿ç”¨ synchronized æ–¹æ³•å’Œè¯­å¥æ‰€è®¿é—®çš„éšå¼ç›‘è§†å™¨é”ç›¸åŒçš„ä¸€äº›åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚è¯¦ç»†åˆ†æè¯·çœ‹: "),t("a",{attrs:{href:"https://www.pdai.tech/md/java/thread/java-thread-x-lock-ReentrantLock.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("JUCé”: ReentrantLockè¯¦è§£"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"å†æ·±å…¥ç†è§£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†æ·±å…¥ç†è§£"}},[s._v("#")]),s._v(" "),t("strong",[s._v("å†æ·±å…¥ç†è§£")])]),s._v(" "),t("p",[s._v("synchronizedæ˜¯é€šè¿‡è½¯ä»¶(JVM)å®ç°çš„ï¼Œç®€å•æ˜“ç”¨ï¼Œå³ä½¿åœ¨JDK5ä¹‹åæœ‰äº†Lockï¼Œä»ç„¶è¢«å¹¿æ³›åœ°ä½¿ç”¨ã€‚")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ä½¿ç”¨Synchronizedæœ‰å“ªäº›è¦æ³¨æ„çš„ï¼Ÿ")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("é”å¯¹è±¡ä¸èƒ½ä¸ºç©º")]),s._v("ï¼Œå› ä¸ºé”çš„ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¯¹è±¡å¤´é‡Œ")]),s._v(" "),t("li",[t("strong",[s._v("ä½œç”¨åŸŸä¸å®œè¿‡å¤§")]),s._v("ï¼Œå½±å“ç¨‹åºæ‰§è¡Œçš„é€Ÿåº¦ï¼Œæ§åˆ¶èŒƒå›´è¿‡å¤§ï¼Œç¼–å†™ä»£ç ä¹Ÿå®¹æ˜“å‡ºé”™")]),s._v(" "),t("li",[t("strong",[s._v("é¿å…æ­»é”")])]),s._v(" "),t("li",[s._v("åœ¨"),t("strong",[s._v("èƒ½é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œæ—¢ä¸è¦ç”¨Lockä¹Ÿä¸è¦ç”¨synchronizedå…³é”®å­—ï¼Œç”¨java.util.concurrentåŒ…ä¸­çš„å„ç§å„æ ·çš„ç±»")]),s._v("ï¼Œå¦‚æœä¸ç”¨è¯¥åŒ…ä¸‹çš„ç±»ï¼Œåœ¨æ»¡è¶³ä¸šåŠ¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨synchronizedå…³é”®ï¼Œå› ä¸ºä»£ç é‡å°‘ï¼Œé¿å…å‡ºé”™")])])]),s._v(" "),t("li",[t("strong",[s._v("synchronizedæ˜¯å…¬å¹³é”å—ï¼Ÿ")])])]),s._v(" "),t("p",[s._v("synchronizedå®é™…ä¸Šæ˜¯"),t("strong",[s._v("éå…¬å¹³çš„")]),s._v("ï¼Œæ–°æ¥çš„çº¿ç¨‹æœ‰å¯èƒ½ç«‹å³è·å¾—ç›‘è§†å™¨ï¼Œè€Œåœ¨ç­‰å¾…åŒºä¸­ç­‰å€™å·²ä¹…çš„çº¿ç¨‹å¯èƒ½å†æ¬¡ç­‰å¾…ï¼Œè¿™æ ·æœ‰åˆ©äºæé«˜æ€§èƒ½ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´é¥¥é¥¿ç°è±¡ã€‚")]),s._v(" "),t("h2",{attrs:{id:"å‚è€ƒæ–‡ç« "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡ç« "}},[s._v("#")]),s._v(" å‚è€ƒæ–‡ç« ")]),s._v(" "),t("p",[s._v("+ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹\n+ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹")]),s._v(" "),t("ul",[t("li",[s._v("https://juejin.im/post/5ae6dc04f265da0ba351d3ff")]),s._v(" "),t("li",[s._v("https://www.cnblogs.com/javaminer/p/3889023.html")]),s._v(" "),t("li",[s._v("https://www.jianshu.com/p/dab7745c0954")]),s._v(" "),t("li",[s._v("https://www.cnblogs.com/wuchaodzxx/p/6867546.html")]),s._v(" "),t("li",[s._v("https://www.cnblogs.com/xyabk/p/10901291.html")]),s._v(" "),t("li",[s._v("https://www.jianshu.com/p/64240319ed60")])])])}),[],!1,null,null,null);n.default=e.exports}}]);