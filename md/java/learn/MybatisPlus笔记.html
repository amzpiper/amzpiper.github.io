<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mybatis-Plus | 私人知识图书馆</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, MongoDB, Docker, k8s, CI&amp;CD, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 源码阅读，读书笔记, 开源项目...">
    <meta name="robots" content="all">
    <meta name="author" content="pdai">
    <meta name="keywords" content="私人知识图书馆, java体系, java知识体系, java框架,java详解,java学习路线,java spring, java面试, 知识体系, java技术体系, java编程, java编程指南,java开发体系, java开发,java教程,java,java数据结构, 算法, 开发基础">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.cb877f3d.css" as="style"><link rel="preload" href="/assets/js/app.7437448f.js" as="script"><link rel="preload" href="/assets/js/5.ea3a467f.js" as="script"><link rel="preload" href="/assets/js/16.de77b749.js" as="script"><link rel="prefetch" href="/assets/js/10.5ef4c92a.js"><link rel="prefetch" href="/assets/js/11.3f596b90.js"><link rel="prefetch" href="/assets/js/12.b71be16f.js"><link rel="prefetch" href="/assets/js/13.d6271850.js"><link rel="prefetch" href="/assets/js/14.9ba4f8e3.js"><link rel="prefetch" href="/assets/js/15.62d14093.js"><link rel="prefetch" href="/assets/js/17.b28c1669.js"><link rel="prefetch" href="/assets/js/18.65db727f.js"><link rel="prefetch" href="/assets/js/19.f0cab2cf.js"><link rel="prefetch" href="/assets/js/2.5197edd9.js"><link rel="prefetch" href="/assets/js/20.bc2a1ebe.js"><link rel="prefetch" href="/assets/js/21.9d44366f.js"><link rel="prefetch" href="/assets/js/22.8d7f32d4.js"><link rel="prefetch" href="/assets/js/23.7f7b97fc.js"><link rel="prefetch" href="/assets/js/24.b84a7d83.js"><link rel="prefetch" href="/assets/js/25.a12b8134.js"><link rel="prefetch" href="/assets/js/26.d6cf3bce.js"><link rel="prefetch" href="/assets/js/27.304e0d0a.js"><link rel="prefetch" href="/assets/js/28.12e94d0e.js"><link rel="prefetch" href="/assets/js/29.79c71861.js"><link rel="prefetch" href="/assets/js/3.310235c4.js"><link rel="prefetch" href="/assets/js/30.90aec520.js"><link rel="prefetch" href="/assets/js/31.59769de4.js"><link rel="prefetch" href="/assets/js/32.54420f34.js"><link rel="prefetch" href="/assets/js/33.90c0c365.js"><link rel="prefetch" href="/assets/js/4.1fed06c3.js"><link rel="prefetch" href="/assets/js/6.6906b7c0.js"><link rel="prefetch" href="/assets/js/7.6030a7b8.js"><link rel="prefetch" href="/assets/js/8.15f570fb.js"><link rel="prefetch" href="/assets/js/9.bbacd143.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb877f3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="私人知识图书馆" class="logo"> <span class="site-name can-hide">私人知识图书馆</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  概述
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/learn-typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/ChromeExtensions.html" class="nav-link">
  ChromeExtensions
</a></li></ul></li><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Stream.html" class="nav-link">
  Stream
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Optional.html" class="nav-link">
  Optional
</a></li></ul></li><li class="dropdown-item"><h4>
          Java高并发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java线程池.html" class="nav-link">
  Java线程池
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-知识体系.html" class="nav-link">
  高并发-知识体系
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-线程基础.html" class="nav-link">
  高并发-线程基础
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-理论基础.html" class="nav-link">
  高并发-理论基础
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-synchronized.html" class="nav-link">
  关键字-synchronized
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-volatile.html" class="nav-link">
  关键字-volatile
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-final.html" class="nav-link">
  关键字-final
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-ThreadLocal详解.html" class="nav-link">
  高并发-ThreadLocal详解
</a></li></ul></li><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  Spring笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring-MVC笔记.html" class="nav-link">
  SpringMVC笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Mybatis笔记.html" class="nav-link">
  Mybatis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/MybatisPlus笔记.html" class="nav-link">
  MybatisPlus笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  SpringBoot笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Dubbo学习笔记.html" class="nav-link">
  Dubbo笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-zookeeper.html" class="nav-link">
  Zookeeper笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-redis.html" class="nav-link">
  Redis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-elasticstack.html" class="nav-link">
  Elasticstack笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/JVM快速入门篇.html" class="nav-link">
  JVM快速入门篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="方法论" class="dropdown-title"><span class="title">方法论</span> <span class="arrow down"></span></button> <button type="button" aria-label="方法论" class="mobile-dropdown-title"><span class="title">方法论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/method/设计模式.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="版本工具" class="dropdown-title"><span class="title">版本工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="版本工具" class="mobile-dropdown-title"><span class="title">版本工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/tool/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/md/java/tool/Maven学习笔记.html" class="nav-link">
  Maven
</a></li></ul></div></div><div class="nav-item"><a href="/md/about/about-me.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/amzpiper" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  概述
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/learn-typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/ChromeExtensions.html" class="nav-link">
  ChromeExtensions
</a></li></ul></li><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Stream.html" class="nav-link">
  Stream
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Optional.html" class="nav-link">
  Optional
</a></li></ul></li><li class="dropdown-item"><h4>
          Java高并发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java线程池.html" class="nav-link">
  Java线程池
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-知识体系.html" class="nav-link">
  高并发-知识体系
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-线程基础.html" class="nav-link">
  高并发-线程基础
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-理论基础.html" class="nav-link">
  高并发-理论基础
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-synchronized.html" class="nav-link">
  关键字-synchronized
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-volatile.html" class="nav-link">
  关键字-volatile
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/关键字-final.html" class="nav-link">
  关键字-final
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/高并发-ThreadLocal详解.html" class="nav-link">
  高并发-ThreadLocal详解
</a></li></ul></li><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  Spring笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring-MVC笔记.html" class="nav-link">
  SpringMVC笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Mybatis笔记.html" class="nav-link">
  Mybatis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/MybatisPlus笔记.html" class="nav-link">
  MybatisPlus笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  SpringBoot笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Dubbo学习笔记.html" class="nav-link">
  Dubbo笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-zookeeper.html" class="nav-link">
  Zookeeper笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-redis.html" class="nav-link">
  Redis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-elasticstack.html" class="nav-link">
  Elasticstack笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/JVM快速入门篇.html" class="nav-link">
  JVM快速入门篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="方法论" class="dropdown-title"><span class="title">方法论</span> <span class="arrow down"></span></button> <button type="button" aria-label="方法论" class="mobile-dropdown-title"><span class="title">方法论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/method/设计模式.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="版本工具" class="dropdown-title"><span class="title">版本工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="版本工具" class="mobile-dropdown-title"><span class="title">版本工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/tool/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/md/java/tool/Maven学习笔记.html" class="nav-link">
  Maven
</a></li></ul></div></div><div class="nav-item"><a href="/md/about/about-me.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/amzpiper" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/learn-typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/md/java/learn/ChromeExtensions.html" class="sidebar-link">Chrome Extensions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/Java8-Stream.html" class="sidebar-link">Java 8 - Stream</a></li><li><a href="/md/java/learn/Java8-Optional.html" class="sidebar-link">Java 8 - Optional</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java高并发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/Java线程池.html" class="sidebar-link">Java 线程池</a></li><li><a href="/md/java/learn/高并发-知识体系.html" class="sidebar-link">高并发-知识体系</a></li><li><a href="/md/java/learn/高并发-线程基础.html" class="sidebar-link">高并发-线程基础</a></li><li><a href="/md/java/learn/高并发-理论基础.html" class="sidebar-link">高并发-理论基础</a></li><li><a href="/md/java/learn/关键字-synchronized.html" class="sidebar-link">关键字-synchronized</a></li><li><a href="/md/java/learn/关键字-volatile.html" class="sidebar-link">关键字-volatile</a></li><li><a href="/md/java/learn/关键字-final.html" class="sidebar-link">关键字-final</a></li><li><a href="/md/java/learn/高并发-ThreadLocal详解.html" class="sidebar-link">高并发 - ThreadLocal详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/Spring笔记.html" class="sidebar-link">Spring</a></li><li><a href="/md/java/learn/Spring-MVC笔记.html" class="sidebar-link">SpringMVC</a></li><li><a href="/md/java/learn/Mybatis笔记.html" class="sidebar-link">Mybatis</a></li><li><a href="/md/java/learn/MybatisPlus笔记.html" class="active sidebar-link">Mybatis-Plus</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_1-简介" class="sidebar-link">1 简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_1-1-特性" class="sidebar-link">1.1 特性</a></li></ul></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-快速入门" class="sidebar-link">2 快速入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-1-创建数据库mybatis-plus" class="sidebar-link">2.1 创建数据库mybatis_plus</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-2-创建user表" class="sidebar-link">2.2 创建user表</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-3-新建项目mybatis-plus" class="sidebar-link">2.3 新建项目mybatis_plus</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-4-导入依赖" class="sidebar-link">2.4 导入依赖</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-5-连接数据库-配置" class="sidebar-link">2.5 连接数据库-配置</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_2-6-pojo-dao-service-controller" class="sidebar-link">2.6 pojo-dao-service-controller</a></li></ul></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_3-配置日志" class="sidebar-link">3 配置日志</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-crud扩展" class="sidebar-link">4 CRUD扩展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-1-插入" class="sidebar-link">4.1 插入</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-2-更新" class="sidebar-link">4.2 更新</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-3-自动化填充时间字段" class="sidebar-link">4.3 自动化填充时间字段</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-4-乐观锁" class="sidebar-link">4.4 乐观锁</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-5-查询操作" class="sidebar-link">4.5 查询操作</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-6-分页查询" class="sidebar-link">4.6 分页查询</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-7-删除" class="sidebar-link">4.7 删除</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_4-8-逻辑删除" class="sidebar-link">4.8 逻辑删除</a></li></ul></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_5-扩展-主键生成策略" class="sidebar-link">5 扩展：主键生成策略：</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_6-性能分析插件" class="sidebar-link">6 性能分析插件</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_7-条件过滤器wrapper" class="sidebar-link">7 条件过滤器Wrapper</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/MybatisPlus笔记.html#_8-代码自动生成器" class="sidebar-link">8 代码自动生成器</a></li></ul></li><li><a href="/md/java/learn/SpringBoot笔记.html" class="sidebar-link">SpringBoot</a></li><li><a href="/md/java/learn/learn-zookeeper.html" class="sidebar-link">Zookeeper</a></li><li><a href="/md/java/learn/learn-redis.html" class="sidebar-link">Redis</a></li><li><a href="/md/java/learn/learn-elasticstack.html" class="sidebar-link">Elasticstack</a></li><li><a href="/md/java/learn/Dubbo学习笔记.html" class="sidebar-link">Dubbo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JVM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/JVM快速入门篇.html" class="sidebar-link">JVM快速入门篇</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mybatis-plus"><a href="#mybatis-plus" class="header-anchor">#</a> Mybatis-Plus</h1> <blockquote><p>MybatisPlus可以节省大量时间，CRUD代码都可以自动化。
JPA（仅有springboot时用的多）、tk-mapper（开源项目用的比较多 ）、MybatisPlus（偷懒的用的比较多）</p></blockquote> <h2 id="_1-简介"><a href="#_1-简介" class="header-anchor">#</a> 1 简介</h2> <p>🚀为简化开发而生</p> <p>官网：<a href="https://baomidou.com/" target="_blank" rel="noopener noreferrer">https://baomidou.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong><a href="https://github.com/baomidou/mybatis-plus" target="_blank" rel="noopener noreferrer">MyBatis-Plus (opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>（简称 MP）是一个 **<a href="https://www.mybatis.org/mybatis-3/" target="_blank" rel="noopener noreferrer">MyBatis (opens new window)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>**的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</p> <h3 id="_1-1-特性"><a href="#_1-1-特性" class="header-anchor">#</a> 1.1 特性</h3> <ul><li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li> <li><strong>损耗小</strong>：启动即会<strong>自动注入基本 CURD</strong>，性能基本无损耗，直接面向对象操作，Basemapper自动生产对应的crud操作。</li> <li><strong>强大的 CRUD 操作</strong>：<strong>内置通用 Mapper、通用 Service</strong>，仅仅通过<strong>少量配置即可实现单表大部分 CRUD 操作</strong>，更有强大的条件构造器，满足各类使用需求</li> <li><strong>支持 Lambda 形式调用</strong>：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li> <li><strong>支持主键自动生成</strong>：支持多达 4 种主键策略（内含<strong>分布式唯一 ID 生成器</strong> - Sequence），可自由配置，完美解决主键问题</li> <li><strong>支持 ActiveRecord 模式</strong>：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li> <li><strong>支持自定义全局通用操作</strong>：支持全局通用方法注入（ Write once, use anywhere ）</li> <li><strong>内置代码生成器</strong>：采用代码或者 Maven 插件可<strong>快速生成 Mapper 、 Model 、 Service 、 Controller 层代码</strong>，支持模板引擎，更有超多自定义配置等您来使用</li> <li><strong>内置分页插件</strong>：<strong>基于MyBatis 物理分页</strong>，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询，不需要用page-helper了。</li> <li><strong>分页插件支持多种数据库</strong>：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer 等多种数据库</li> <li><strong>内置性能分析插件</strong>：可输出 SQL 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li> <li><strong>内置全局拦截插件</strong>：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li></ul> <h2 id="_2-快速入门"><a href="#_2-快速入门" class="header-anchor">#</a> 2 快速入门</h2> <p>使用第三方组件：</p> <p>1、导入相应的依赖</p> <p>2、研究依赖如何配置</p> <p>3、代码如何编写</p> <p>4、提高扩展技术能力</p> <h3 id="_2-1-创建数据库mybatis-plus"><a href="#_2-1-创建数据库mybatis-plus" class="header-anchor">#</a> 2.1 创建数据库mybatis_plus</h3> <h3 id="_2-2-创建user表"><a href="#_2-2-创建user表" class="header-anchor">#</a> 2.2 创建user表</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'邮箱'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Jone'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'test1@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'test2@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">'test3@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Sandy'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">'test4@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'Billie'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'test5@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 真是开发中，version（乐观锁）、deleted（逻辑删除）、gmt_create、gmt_modified</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-3-新建项目mybatis-plus"><a href="#_2-3-新建项目mybatis-plus" class="header-anchor">#</a> 2.3 新建项目mybatis_plus</h3> <h3 id="_2-4-导入依赖"><a href="#_2-4-导入依赖" class="header-anchor">#</a> 2.4 导入依赖</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token comment">--web--&gt;</span>
<span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>web<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token comment">--数据库--&gt;</span>
<span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token comment">--lombok--&gt;</span>
<span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token comment">--mybatis-plus,不是官方的--&gt;</span>
<span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>com<span class="token punctuation">.</span>baomidou<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>mybatis<span class="token operator">-</span>plus<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">3.0</span><span class="token number">.5</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>说明：使用mybatis-plus可以节省大量的代码，不要同时导入mybatis和mybatis-plus</p> <h3 id="_2-5-连接数据库-配置"><a href="#_2-5-连接数据库-配置" class="header-anchor">#</a> 2.5 连接数据库-配置</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 应用名称</span>
spring<span class="token punctuation">.</span>application<span class="token punctuation">.</span>name<span class="token operator">=</span>mybatis_plus
<span class="token comment"># 应用服务 WEB 访问端口</span>
server<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">8080</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>username<span class="token operator">=</span>root
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token number">1234</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc:mysql:<span class="token comment">//localhost:3306/mybatis_plus?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>driver<span class="token operator">-</span>class<span class="token operator">-</span>name<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_2-6-pojo-dao-service-controller"><a href="#_2-6-pojo-dao-service-controller" class="header-anchor">#</a> 2.6 pojo-dao-service-controller</h3> <p>传统方式dao需要配置mapper.xml</p> <p>现在步骤：</p> <p>1.pojo</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">public</span> class <span class="token keyword">User</span> {

    private Long id<span class="token punctuation">;</span>
    private String name<span class="token punctuation">;</span>
    private <span class="token keyword">Integer</span> age<span class="token punctuation">;</span>
    private String email<span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2.mapper接口</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/**
 * @author 郭宇航
 * @date 2022/1/4
 * @apiNote 使用mybatis-plus后,只需要实现基本的接口BaseMapper
 */</span>
<span class="token comment">// Repository表示为dao层的就可以了</span>
<span class="token variable">@Repository</span>
<span class="token keyword">public</span> interface UserMapper extends BaseMapper<span class="token operator">&lt;</span><span class="token keyword">User</span><span class="token operator">&gt;</span> {
    <span class="token comment">//所有的CRUD都已经自动生成了。</span>
    <span class="token comment">//不需要像以前那样配置一大堆文件里</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>3.main</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">//扫描mapper接口</span>
<span class="token variable">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.kuang.mapper&quot;</span><span class="token punctuation">)</span>
<span class="token variable">@SpringBootApplication</span>
<span class="token keyword">public</span> class MybatisPlusApplication {

    <span class="token keyword">public</span> static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> {
        SpringApplication<span class="token punctuation">.</span>run<span class="token punctuation">(</span>MybatisPlusApplication<span class="token punctuation">.</span>class<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>4.使用</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/**
 * 基础了BaseMapper，所有的方法都来自父类
 */</span>
<span class="token variable">@Autowired</span>
private UserMapper userMapper<span class="token punctuation">;</span>

<span class="token variable">@Test</span>
void contextLoads<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 查询全部用户</span>
    <span class="token comment">// 参数是一个wapper，一个条件构造器</span>
    List<span class="token operator">&lt;</span><span class="token keyword">User</span><span class="token operator">&gt;</span> users <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectList<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span>forEach<span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token keyword">out</span>::println<span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>注意：需要在主启动类添加<code>@MapperScan*(*&quot;com.kuang.mapper&quot;*)*</code></p> <p>思考问题：
1.SQL谁写的？Mybatis-Plus
2.方法哪里来的？Mybatis-Plus</p> <h2 id="_3-配置日志"><a href="#_3-配置日志" class="header-anchor">#</a> 3 配置日志</h2> <p>因为所有的sql是不可见的，希望知道他是怎么执行的 ，必须看日志！</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#配置日志</span>
mybatis<span class="token operator">-</span>plus<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>log<span class="token operator">-</span>impl<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>StdOutImpl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/Untitled.ee9b4532.png" alt="Untitled"></p> <p>配置完之后，后面的日志需要注意这个自动生产的SQL，会喜欢上Mybatis-</p> <h2 id="_4-crud扩展"><a href="#_4-crud扩展" class="header-anchor">#</a> 4 CRUD扩展</h2> <h3 id="_4-1-插入"><a href="#_4-1-插入" class="header-anchor">#</a> 4.1 插入</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Test</span>
    void contextLoads2<span class="token punctuation">(</span><span class="token punctuation">)</span> {
        <span class="token keyword">User</span> <span class="token keyword">user</span> <span class="token operator">=</span> new <span class="token keyword">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">user</span><span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">user</span><span class="token punctuation">.</span>setAge<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">user</span><span class="token punctuation">.</span>setEmail<span class="token punctuation">(</span><span class="token string">&quot;15512702732@163.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 插入</span>
        <span class="token keyword">int</span> <span class="token keyword">insert</span> <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">insert</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="/assets/img/Untitled1.de71ebe7.png" alt="Untitled"></p> <p>帮我们自动生产了id，并且id会自动回填到user对象中。</p> <p>数据库默认插入的是唯一默认值，为什么这里自动生成的是1478268198860804098</p> <p><strong>默认注解策略：<code>@TableId*(*type = IdType.*ID_WORKER)*</code></strong></p> <p><strong>1、主键自增策略：<em><code>AUTO</code></em></strong></p> <p>1.实体类字段上增加<code>@TableId*(*type = IdType.*AUTO)*</code></p> <p>2.数据库中配置为自增！</p> <p>3.测试插入</p> <p>User(id=1478268198860804099, name=测试, age=3, <a href="mailto:email=15512702732@163.com">email=15512702732@163.com</a>)</p> <p><strong>2、其他策略：</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>AUTO<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 自增
NONE<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 未设置主键
INPUT<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 手动输入<span class="token punctuation">,</span>必须要自己写id
ID_WORKER<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  默认全局唯一id
UUID<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  全局唯一id uuid
ID_WORKER_STR<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> id_worker字符串表示法
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_4-2-更新"><a href="#_4-2-更新" class="header-anchor">#</a> 4.2 更新</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Test</span>
void contextLoads3<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token keyword">User</span> <span class="token keyword">user</span> <span class="token operator">=</span> new <span class="token keyword">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setId<span class="token punctuation">(</span><span class="token number">1478268198860804099</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setAge<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setEmail<span class="token punctuation">(</span><span class="token string">&quot;15512702732@163.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 更新,参数是一个对象</span>
    <span class="token keyword">int</span> <span class="token keyword">insert</span> <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>updateById<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">insert</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>通过条件自动拼接了动态sql：</p> <p><img src="/assets/img/Untitled2.0241cd2c.png" alt="Untitled"></p> <h3 id="_4-3-自动化填充时间字段"><a href="#_4-3-自动化填充时间字段" class="header-anchor">#</a> 4.3 自动化填充时间字段</h3> <p><a href="https://baomidou.com/pages/4c6bcf/" target="_blank" rel="noopener noreferrer">https://baomidou.com/pages/4c6bcf/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>比如：创建时间、修改时间！这些操作.</p> <p>alibaba规定所有的数据库表必须包含2个字段：gmt_create、gmt_modified，这两个字段几乎所有的表都要配置上，而且需要自动化！</p> <p><strong>两中方式：</strong></p> <p>方法一、数据库级别(工作中不允许使用)</p> <p>1、新增字段create_time/update_time</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>mybatis_plus<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> 
<span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">AFTER</span> <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、测试插入方法，同步实体类</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">public</span> class <span class="token keyword">User</span> {

    private Long id<span class="token punctuation">;</span>
    private String name<span class="token punctuation">;</span>
    private <span class="token keyword">Integer</span> age<span class="token punctuation">;</span>
    private String email<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token operator">*</span>private <span class="token keyword">Date</span> createTime<span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>方法二、代码级别</p> <p>1、删除数据库的默认值</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>mybatis_plus<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> 
CHANGE <span class="token keyword">COLUMN</span> <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token boolean">NULL</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、实体类的属性上需要增加注解-mybatisplus实现的</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">public</span> class <span class="token keyword">User</span> {

    private Long id<span class="token punctuation">;</span>
    private String name<span class="token punctuation">;</span>
    private <span class="token keyword">Integer</span> age<span class="token punctuation">;</span>
    private String email<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token operator">*</span><span class="token variable">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> FieldFill<span class="token punctuation">.</span>INSERT_UPDATE<span class="token punctuation">)</span>
    private <span class="token keyword">Date</span> createTime<span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span>

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>3、编写处理器处理注解</p> <p>mybatis plus已经有了相应的接口,实现处理器接口，并编写插入和更新时的方法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Component</span> <span class="token comment">// 一定不要忘了把处理器添加到Bean中</span>
<span class="token variable">@Slf4j</span>
<span class="token keyword">public</span> class TimeMetaObjectHandler implements MetaObjectHandler {
    <span class="token comment">/**
     * 插入时的填充策略
     * @param metaObject
     */</span>
    <span class="token variable">@Override</span>
    <span class="token keyword">public</span> void insertFill<span class="token punctuation">(</span>MetaObject metaObject<span class="token punctuation">)</span> {
        log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;start insert fill ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// String fieldName, Object fieldVal, MetaObject metaObject</span>
        this<span class="token punctuation">.</span>setFieldValByName<span class="token punctuation">(</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> new <span class="token keyword">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    }

    <span class="token comment">/**
     * 更新时的填充策略
     * @param metaObject
     */</span>
    <span class="token variable">@Override</span>
    <span class="token keyword">public</span> void updateFill<span class="token punctuation">(</span>MetaObject metaObject<span class="token punctuation">)</span> {
        log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;start update fill ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token punctuation">.</span>setFieldValByName<span class="token punctuation">(</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> new <span class="token keyword">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>4、测试插入，观察时间</p> <p><img src="/assets/img/Untitled3.927524f7.png" alt="Untitled"></p> <h3 id="_4-4-乐观锁"><a href="#_4-4-乐观锁" class="header-anchor">#</a> 4.4 乐观锁</h3> <p>在面试中，经常被闻到乐观锁，悲观锁！juc课程中讲了。</p> <aside>
💡 **乐观锁：**顾名思义十分乐观，总是认为不会出现问题，无论干什么都不去上锁！如果出现了问题，再次更新值后重试。一般使用version和new version字段。判断版本号是否更新了，来确定这个数据到底有没有更新。
**悲观锁：**十分悲观，认为总是会出现问题，无论干什么都会上锁！再操作。
</aside> <p><strong>讲解乐观锁机制：</strong></p> <p><a href="https://baomidou.com/pages/0d93c0/#optimisticlockerinnerinterceptor" target="_blank" rel="noopener noreferrer">https://baomidou.com/pages/0d93c0/#optimisticlockerinnerinterceptor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>当要更新一条记录的时候，希望这条记录没有被别人更新乐观锁实现方式：</p> <blockquote><p>取出记录时，获取当前 version
更新时，带上这个 version
执行更新时， set version = newVersion where version = oldVersion
如果 version 不对，就更新失败</p></blockquote> <p>步骤：</p> <p>1、先查询获取版本号</p> <p>2、更新时条件带上刚在取得的版本号，只有相同时才能执行成功。</p> <p>3、更新版本号数据时要把版本号+1。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">&quot;kuang&quot;</span><span class="token punctuation">,</span> version <span class="token operator">=</span> version<span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> version <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>测试mybatis-plus乐观锁插件：</strong></p> <p>1、增加version字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>mybatis_plus<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> 
<span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> <span class="token identifier"><span class="token punctuation">`</span>version<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span> <span class="token keyword">AFTER</span> <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、更新pojo</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Version</span> <span class="token comment">//乐观锁注解</span>
private <span class="token keyword">Integer</span> version<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3、注册组件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Bean</span>
<span class="token keyword">public</span> OptimisticLockerInterceptor optimisticLockerInterceptor<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token keyword">return</span> new OptimisticLockerInterceptor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>4、测试成功的案例：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Test</span>
void contextLoads4<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 测试乐观锁成功！</span>
    <span class="token comment">// 1.查询用户信息</span>
    <span class="token keyword">User</span> <span class="token keyword">user</span> <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.修改</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;123123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3.执行更新，参数是一个对象</span>
    <span class="token keyword">int</span> updateById <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>updateById<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span>updateById<span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>结果：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Creating a new SqlSession
SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@7b6c6e70</span><span class="token punctuation">]</span> was <span class="token operator">not</span> registered <span class="token keyword">for</span> synchronization because synchronization <span class="token operator">is</span> <span class="token operator">not</span> active
JDBC Connection <span class="token punctuation">[</span>HikariProxyConnection<span class="token variable">@437098149</span> wrapping com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>ConnectionImpl<span class="token variable">@5a02bfe3</span><span class="token punctuation">]</span> will <span class="token operator">not</span> be managed <span class="token keyword">by</span> Spring
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span>  Preparing: <span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>email<span class="token punctuation">,</span>version<span class="token punctuation">,</span>create_time <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> id<span class="token operator">=</span>? 
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> Parameters: <span class="token number">1</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span>
<span class="token operator">&lt;=</span><span class="token operator">=</span>    <span class="token keyword">Columns</span>: id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email<span class="token punctuation">,</span> version<span class="token punctuation">,</span> create_time
<span class="token operator">&lt;=</span><span class="token operator">=</span>        <span class="token keyword">Row</span>: <span class="token number">1</span><span class="token punctuation">,</span> Jone<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> test1<span class="token variable">@baomidou.com</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token number">1</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">15</span>:<span class="token number">59</span>:<span class="token number">26</span>
<span class="token operator">&lt;=</span><span class="token operator">=</span>      Total: <span class="token number">1</span>
Closing non transactional SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@7b6c6e70</span><span class="token punctuation">]</span>
Creating a new SqlSession
SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@123d7057</span><span class="token punctuation">]</span> was <span class="token operator">not</span> registered <span class="token keyword">for</span> synchronization because synchronization <span class="token operator">is</span> <span class="token operator">not</span> active
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">33</span>:<span class="token number">14.438</span>  INFO <span class="token number">13096</span> <span class="token comment">--- [           main] com.kuang.handler.TimeMetaObjectHandler  : start update fill ...</span>
JDBC Connection <span class="token punctuation">[</span>HikariProxyConnection<span class="token variable">@541769471</span> wrapping com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>ConnectionImpl<span class="token variable">@5a02bfe3</span><span class="token punctuation">]</span> will <span class="token operator">not</span> be managed <span class="token keyword">by</span> Spring
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span>  Preparing: <span class="token keyword">UPDATE</span> <span class="token keyword">user</span> <span class="token keyword">SET</span> name<span class="token operator">=</span>?<span class="token punctuation">,</span> age<span class="token operator">=</span>?<span class="token punctuation">,</span> email<span class="token operator">=</span>?<span class="token punctuation">,</span> version<span class="token operator">=</span>?<span class="token punctuation">,</span> create_time<span class="token operator">=</span>? <span class="token keyword">WHERE</span> id<span class="token operator">=</span>? <span class="token operator">AND</span> version<span class="token operator">=</span>? 
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> Parameters: <span class="token number">123123</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test1<span class="token variable">@baomidou.com</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">33</span>:<span class="token number">14.438</span><span class="token punctuation">(</span><span class="token keyword">Timestamp</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">(</span>Long<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span>
<span class="token operator">&lt;=</span><span class="token operator">=</span>    Updates: <span class="token number">1</span>
Closing non transactional SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@123d7057</span><span class="token punctuation">]</span>
<span class="token number">1</span>
<span class="token keyword">User</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token number">123123</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">,</span> email<span class="token operator">=</span>test1<span class="token variable">@baomidou.com</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>version<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">,</span> createTime<span class="token operator">=</span>Tue Jan <span class="token number">04</span> <span class="token number">15</span>:<span class="token number">59</span>:<span class="token number">26</span> CST <span class="token number">2022</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>5、测试失败的案例：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Test</span>
void contextLoads5<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 测试乐观锁失败！</span>
    <span class="token comment">// 线程1</span>
    <span class="token comment">// 1.1.查询用户信息</span>
    <span class="token keyword">User</span> <span class="token keyword">user</span> <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1.2.修改</span>
    <span class="token keyword">user</span><span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;123123111111111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 线程2</span>
    <span class="token comment">// 2.1.查询用户信息</span>
    <span class="token keyword">User</span> user2 <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2.修改</span>
    user2<span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;123123222222222&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.3.执行更新第二个线程，插队了抢先线程1更新</span>
    userMapper<span class="token punctuation">.</span>updateById<span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 1.3.执行更新第一个线程的。如果没有乐观锁就会覆盖插队线程的数据。</span>
    <span class="token comment">// **实现自旋锁实现多次尝试! JUC课程</span>
	  <span class="token comment">// 多线程一定要加suo**</span>
    userMapper<span class="token punctuation">.</span>updateById<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>结果：1.3更新失败了。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Creating a new SqlSession
SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@521bb1a4</span><span class="token punctuation">]</span> was <span class="token operator">not</span> registered <span class="token keyword">for</span> synchronization because synchronization <span class="token operator">is</span> <span class="token operator">not</span> active
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">38</span>:<span class="token number">33.808</span>  INFO <span class="token number">12520</span> <span class="token comment">--- [           main] com.kuang.handler.TimeMetaObjectHandler  : start update fill ...</span>
JDBC Connection <span class="token punctuation">[</span>HikariProxyConnection<span class="token variable">@598284487</span> wrapping com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>ConnectionImpl<span class="token variable">@6deee370</span><span class="token punctuation">]</span> will <span class="token operator">not</span> be managed <span class="token keyword">by</span> Spring
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span>  Preparing: <span class="token keyword">UPDATE</span> <span class="token keyword">user</span> <span class="token keyword">SET</span> name<span class="token operator">=</span>?<span class="token punctuation">,</span> age<span class="token operator">=</span>?<span class="token punctuation">,</span> email<span class="token operator">=</span>?<span class="token punctuation">,</span> version<span class="token operator">=</span>?<span class="token punctuation">,</span> create_time<span class="token operator">=</span>? <span class="token keyword">WHERE</span> id<span class="token operator">=</span>? <span class="token operator">AND</span> version<span class="token operator">=</span>? 
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> Parameters: <span class="token number">123123222222222</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test1<span class="token variable">@baomidou.com</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">38</span>:<span class="token number">33.808</span><span class="token punctuation">(</span><span class="token keyword">Timestamp</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">(</span>Long<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">&lt;=</span><span class="token operator">=</span>    Updates: <span class="token number">1</span><span class="token operator">*</span><span class="token operator">*</span>
Closing non transactional SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@521bb1a4</span><span class="token punctuation">]</span>
Creating a new SqlSession
SqlSession <span class="token punctuation">[</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span><span class="token keyword">session</span><span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token variable">@4b4ee511</span><span class="token punctuation">]</span> was <span class="token operator">not</span> registered <span class="token keyword">for</span> synchronization because synchronization <span class="token operator">is</span> <span class="token operator">not</span> active
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">38</span>:<span class="token number">33.826</span>  INFO <span class="token number">12520</span> <span class="token comment">--- [           main] com.kuang.handler.TimeMetaObjectHandler  : start update fill ...</span>
JDBC Connection <span class="token punctuation">[</span>HikariProxyConnection<span class="token variable">@526874139</span> wrapping com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>ConnectionImpl<span class="token variable">@6deee370</span><span class="token punctuation">]</span> will <span class="token operator">not</span> be managed <span class="token keyword">by</span> Spring
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span>  Preparing: <span class="token keyword">UPDATE</span> <span class="token keyword">user</span> <span class="token keyword">SET</span> name<span class="token operator">=</span>?<span class="token punctuation">,</span> age<span class="token operator">=</span>?<span class="token punctuation">,</span> email<span class="token operator">=</span>?<span class="token punctuation">,</span> version<span class="token operator">=</span>?<span class="token punctuation">,</span> create_time<span class="token operator">=</span>? <span class="token keyword">WHERE</span> id<span class="token operator">=</span>? <span class="token operator">AND</span> version<span class="token operator">=</span>? 
<span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> Parameters: <span class="token number">123123111111111</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> test1<span class="token variable">@baomidou.com</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">04</span> <span class="token number">16</span>:<span class="token number">38</span>:<span class="token number">33.826</span><span class="token punctuation">(</span><span class="token keyword">Timestamp</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">(</span>Long<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">(</span><span class="token keyword">Integer</span><span class="token punctuation">)</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">&lt;=</span><span class="token operator">=</span>    Updates: <span class="token number">0</span><span class="token operator">*</span><span class="token operator">*</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_4-5-查询操作"><a href="#_4-5-查询操作" class="header-anchor">#</a> 4.5 查询操作</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@Test</span>
void contextLoads6<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 查询单个操作</span>
    <span class="token keyword">User</span> <span class="token keyword">user</span> <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectById<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span><span class="token keyword">out</span><span class="token punctuation">.</span>println<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}

<span class="token variable">@Test</span>
void contextLoads7<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 查询多个操作</span>
    <span class="token comment">// SELECT id,name,age,email,version,create_time FROM user WHERE id IN ( ? , ? , ? )</span>
    List<span class="token operator">&lt;</span><span class="token keyword">User</span><span class="token operator">&gt;</span> users <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectBatchIds<span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span>asList<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span>forEach<span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token keyword">out</span>::println<span class="token punctuation">)</span><span class="token punctuation">;</span>
}

<span class="token variable">@Test</span>
void contextLoads8<span class="token punctuation">(</span><span class="token punctuation">)</span> {
    <span class="token comment">// 多条件查询map,**复杂的会用mapper操作**</span>
    <span class="token comment">// SELECT id,name,age,email,version,create_time FROM user WHERE name = ?</span>
    HashMap<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">&gt;</span> map <span class="token operator">=</span> new HashMap<span class="token operator">&lt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span><span class="token keyword">User</span><span class="token operator">&gt;</span> users <span class="token operator">=</span> userMapper<span class="token punctuation">.</span>selectByMap<span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_4-6-分页查询"><a href="#_4-6-分页查询" class="header-anchor">#</a> 4.6 分页查询</h3> <aside>
💡 方式：
1、原始分页
2、pagehelper第三方插件
3、mybatisplus内置了分页插件
</aside> <p>mybatisplus内置了分页插件：</p> <p>1、配置拦截器组件</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">PaginationInterceptor</span> <span class="token function">paginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">PaginationInterceptor</span> paginationInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PaginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置请求的页面大于最大页后的操作，true调回首页，false继续请求，默认false</span>
    paginationInterceptor<span class="token punctuation">.</span><span class="token function">setOverflow</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> paginationInterceptor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2、使用Page对象</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">contextLoads9</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分页查询,参数1：当前页，参数2：页面大小</span>
    <span class="token comment">// SELECT id,name,age,email,version,create_time FROM user LIMIT 10,10</span>
    <span class="token class-name">Page</span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IPage</span> selectPage <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 返回数据</span>
    selectPage<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 总数</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>selectPage<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_4-7-删除"><a href="#_4-7-删除" class="header-anchor">#</a> 4.7 删除</h3> <p>基本删除操作：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">contextLoads10</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 删除操作,id删除</span>
    <span class="token comment">//userMapper.deleteById(1478278183120453634L);</span>
    <span class="token comment">// 批量删除,list</span>
    <span class="token comment">//userMapper.deleteBatchIds(Arrays.asList(1478268198860804099L,1478275780337917954L));</span>
    <span class="token comment">// 条件删除</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userMapper<span class="token punctuation">.</span><span class="token function">deleteByMap</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_4-8-逻辑删除"><a href="#_4-8-逻辑删除" class="header-anchor">#</a> 4.8 逻辑删除</h3> <p>工作中常遇到一些问题。</p> <p>物理删除：在数据库中移除。
逻辑删除：在数据库中没有被移除，通过变量让他失效。deleted=0 ⇒ deleted=1</p> <p>防止数据的删除，类似回收站。</p> <p>1、增加deleted字段</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>ALTER TABLE `mybatis_plus`<span class="token punctuation">.</span>`user` 
ADD COLUMN `deleted` INT NULL DEFAULT <span class="token number">0</span> AFTER `version`<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、修改实体类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@TableLogic</span>
<span class="token keyword">private</span> <span class="token class-name">Integer</span> deleted<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3、配置</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//逻辑删除</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ISqlInjector</span> <span class="token function">sqlInjector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogicSqlInjector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

#配置逻辑删除<span class="token punctuation">,</span>删除为<span class="token number">1</span><span class="token punctuation">,</span>没删除为<span class="token number">0</span>
mybatis<span class="token operator">-</span>plus<span class="token punctuation">.</span>global<span class="token operator">-</span>config<span class="token punctuation">.</span>db<span class="token operator">-</span>config<span class="token punctuation">.</span>logic<span class="token operator">-</span>delete<span class="token operator">-</span>value<span class="token operator">=</span><span class="token number">1</span>
mybatis<span class="token operator">-</span>plus<span class="token punctuation">.</span>global<span class="token operator">-</span>config<span class="token punctuation">.</span>db<span class="token operator">-</span>config<span class="token punctuation">.</span>logic<span class="token operator">-</span>not<span class="token operator">-</span>delete<span class="token operator">-</span>value<span class="token operator">=</span><span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>4、使用删除</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">contextLoads11</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 逻辑删除,执行的是更新操作</span>
    userMapper<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="/assets/img/Untitled4.c8b592c3.png" alt="Untitled"></p> <p>5、查询操作会自动过滤被逻辑删除的字段，拼接上where deleted=0</p> <p>以上的所有CRUD及其扩展操作，必须精通。会大大提高写项目的效率。</p> <h2 id="_5-扩展-主键生成策略"><a href="#_5-扩展-主键生成策略" class="header-anchor">#</a> 5 扩展：<strong>主键生成策略：</strong></h2> <p><a href="https://www.cnblogs.com/haoxinyue/p/5208136.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/haoxinyue/p/5208136.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>id对应数据库中的主键，生成策略：uuid、自增id、雪花算法、redis、zookeeper</p> <p><strong>1. 数据库自增长序列或字段</strong></p> <p>最常见的方式。利用数据库，全数据库唯一。</p> <p>优点：</p> <p>1）简单，代码方便，性能可以接受。</p> <p>2）数字ID天然排序，对分页或者需要排序的结果很有帮助。</p> <p>缺点：</p> <p>1）不同数据库语法和实现不同，数据库迁移的时候或多数据库版本支持的时候需要处理。</p> <p>2）在单个数据库或读写分离或一主多从的情况下，只有一个主库可以生成。有单点故障的风险。</p> <p>3）在性能达不到要求的情况下，比较难于扩展。（不适用于海量高并发）</p> <p>4）如果遇见多个系统需要合并或者涉及到数据迁移会相当痛苦。</p> <p>5）分表分库的时候会有麻烦。</p> <p>6）并非一定连续，类似MySQL，当生成新ID的事务回滚，那么后续的事务也不会再用这个ID了。这个在性能和连续性的折中。如果为了保证连续，必须要在事务结束后才能生成ID，那性能就会出现问题。</p> <p>7）在分布式数据库中，如果采用了自增主键的话，有可能会带来尾部热点。分布式数据库常常使用range的分区方式，在大量新增记录的时候，IO会集中在一个分区上，造成热点数据。</p> <p>优化方案：</p> <p>1）针对主库单点，如果有多个Master库，则每个Master库设置的起始数字不一样，步长一样，可以是Master的个数。比如：Master1 生成的是 1，4，7，10，Master2生成的是2,5,8,11 Master3生成的是 3,6,9,12。这样就可以有效生成集群中的唯一ID，也可以大大降低ID生成数据库操作的负载。</p> <p><strong>2. UUID</strong></p> <p>常见的方式。可以利用数据库也可以利用程序生成，一般来说全球唯一。UUID是由32个的16进制数字组成，所以每个UUID的长度是128位（16^32 = 2^128）。UUID作为一种广泛使用标准，有多个实现版本，影响它的因素包括时间、网卡MAC地址、自定义Namesapce等等。</p> <p>优点：</p> <p>1）简单，代码方便。</p> <p>2）生成ID性能非常好，基本不会有性能问题。</p> <p>3）全球唯一，在遇见数据迁移，系统数据合并，或者数据库变更等情况下，可以从容应对。</p> <p>缺点：</p> <p>1）没有排序，无法保证趋势递增。</p> <p>2）UUID往往是使用字符串存储，查询的效率比较低。</p> <p>3）存储空间比较大，如果是海量数据库，就需要考虑存储量的问题。</p> <p>4）传输数据量大</p> <p>5）不可读。</p> <p>3**. Redis生成ID**</p> <p>当使用数据库来生成ID性能不够要求的时候，我们可以尝试使用Redis来生成ID。这主要依赖于Redis是单线程的，所以也可以用生成全局唯一的ID。可以用Redis的原子操作 INCR和INCRBY来实现。</p> <p>可以使用Redis集群来获取更高的吞吐量。假如一个集群中有5台Redis。可以初始化每台Redis的值分别是1,2,3,4,5，然后步长都是5。各个Redis生成的ID为：</p> <p>A：1,6,11,16,21</p> <p>B：2,7,12,17,22</p> <p>C：3,8,13,18,23</p> <p>D：4,9,14,19,24</p> <p>E：5,10,15,20,25</p> <p>这个，随便负载到哪个机确定好，未来很难做修改。但是3-5台服务器基本能够满足器上，都可以获得不同的ID。但是步长和初始值一定需要事先需要了。使用Redis集群也可以方式单点故障的问题。</p> <p>另外，比较适合使用Redis来生成每天从0开始的流水号。比如订单号=日期+当日自增长号。可以每天在Redis中生成一个Key，使用INCR进行累加。</p> <p>优点：</p> <p>1）不依赖于数据库，灵活方便，且性能优于数据库。</p> <p>2）数字ID天然排序，对分页或者需要排序的结果很有帮助。</p> <p>缺点：</p> <p>1）如果系统中没有Redis，还需要引入新的组件，增加系统复杂度。</p> <p>2）需要编码和配置的工作量比较大。</p> <p>4**.雪花算法-Twitter的snowflake算法（重点）**</p> <p>snowflake是Twitter开源的分布式ID生成算法，结果是一个<strong>long型的ID</strong>。其核心思想是：使用<strong>41bit作为毫秒数</strong>，<strong>10bit作为机器的ID</strong>（<strong>5个bit是数据中心</strong>，<strong>5个bit的机器ID</strong>），<strong>12bit作为毫秒内的流水号</strong>（意味着每个节点在每毫秒可以产生 4096 个 ID），<strong>最后还有一个符号位，永远是0</strong>。具体实现的代码可以参看<a href="https://github.com/twitter/snowflake" target="_blank" rel="noopener noreferrer">https://github.com/twitter/snowflake<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。雪花算法支持的TPS可以达到419万左右（2^22*1000）。</p> <p>可以保证全球唯一。</p> <h2 id="_6-性能分析插件"><a href="#_6-性能分析插件" class="header-anchor">#</a> 6 性能分析插件</h2> <p>我们在平时开发中会遇到慢查询，怎么揪出来？可以用druid等。</p> <p>mybatisplus提供了性能分析插件，如果超过这个时间就停止运行。</p> <blockquote><p>性能分析插件用于输出每条SQL预计及其执行时间。3.2.0以上版本一处推荐使用第三方扩展执行SQL分析打印功能。</p></blockquote> <p>1、导入插件</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 性能分析插件,只有在dev和test环境下开启，为了保证效率</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">PerformanceInterceptor</span> <span class="token function">performanceInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">PerformanceInterceptor</span> performanceInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置sql能够执行的最大时间，如果超过了则不执行。比如：1ms</span>
    <span class="token comment">// 一般设置为100</span>
    performanceInterceptor<span class="token punctuation">.</span><span class="token function">setMaxTime</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// sql格式化</span>
    performanceInterceptor<span class="token punctuation">.</span><span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> performanceInterceptor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

#配置环境
spring<span class="token punctuation">.</span>profiles<span class="token punctuation">.</span>active<span class="token operator">=</span>dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>3、测试使用</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>执行失败后日志：
<span class="token class-name">Time</span>：<span class="token number">23</span> ms <span class="token operator">-</span> ID：<span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>kuang<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span>UserMapper</span><span class="token punctuation">.</span>selectList
<span class="token class-name">Execute</span> SQL：
    <span class="token class-name">SELECT</span>
        id<span class="token punctuation">,</span>
        name<span class="token punctuation">,</span>
        age<span class="token punctuation">,</span>
        email<span class="token punctuation">,</span>
        version<span class="token punctuation">,</span>
        create_time<span class="token punctuation">,</span>
        deleted 
    FROM
        user 
    <span class="token class-name">WHERE</span>
        deleted<span class="token operator">=</span><span class="token number">0</span>

<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span>MyBatisSystemException</span><span class="token operator">:</span> nested exception is <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span>PersistenceException</span><span class="token operator">:</span> 
### <span class="token class-name">Error</span> querying <span class="token class-name"><span class="token namespace">database<span class="token punctuation">.</span></span>  Cause</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span>MybatisPlusException</span><span class="token operator">:</span>  <span class="token class-name">The</span> SQL execution time is too large<span class="token punctuation">,</span> please optimize <span class="token operator">!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>超过规定的时间就会报异常。</p> <p>使用分析插件可以帮助我们提高sql效率。</p> <h2 id="_7-条件过滤器wrapper"><a href="#_7-条件过滤器wrapper" class="header-anchor">#</a> 7 条件过滤器<strong>Wrapper</strong></h2> <p>我们写一些复杂的sql可以使用它替代。</p> <p><a href="https://baomidou.com/pages/10c804/#abstractwrapper" target="_blank" rel="noopener noreferrer">https://baomidou.com/pages/10c804/#abstractwrapper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author 郭宇航
 * @date 2022/1/4
 * @apiNote
 */</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WrapperTest</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 基础了BaseMapper，所有的方法都来自父类
     */</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserMapper</span> userMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 查询复杂的，name不为空，邮箱不为空的数据，年龄大于等于12岁</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 类似map,map直接put，这个使用方法</span>
        wrapper
                <span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ge</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 查询一个数据selectOne,名字为Tom,多个时使用List或Map</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 查询年龄再20~30岁用户</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 模糊查询，名字中不包括a的。并且邮箱以t开头的数据。</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 左和右代表%在左还是右</span>
        wrapper<span class="token punctuation">.</span><span class="token function">notLike</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">likeRight</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> maps <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectMaps</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        maps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 内查询：id小于3</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">inSql</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;select id from user where id &lt; 3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectObjs</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads6</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 降序</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">orderByDesc</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectObjs</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h2 id="_8-代码自动生成器"><a href="#_8-代码自动生成器" class="header-anchor">#</a> 8 代码自动生成器</h2> <p>AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p> <p>1、导入依赖</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>baomidou<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>plus<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.0</span><span class="token number">.5</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>baomidou<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>plus<span class="token operator">-</span>generator<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.0</span><span class="token number">.5</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>velocity<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>velocity<span class="token operator">-</span>engine<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.3</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>2、编写生成器</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author 郭宇航
 * @date 2022/1/4
 * @apiNote
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AutoGeneratorTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//需要一个代码生成器对象</span>
        <span class="token class-name">AutoGenerator</span> mpg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 配置策略</span>
        <span class="token comment">// 1.全局配置</span>
        <span class="token class-name">GlobalConfig</span> gc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GlobalConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取用户目录</span>
        <span class="token class-name">String</span> property <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc<span class="token punctuation">.</span><span class="token function">setOutputDir</span><span class="token punctuation">(</span>property <span class="token operator">+</span> <span class="token string">&quot;/src/main/java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token string">&quot;gyh&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 是否打开文件管理器</span>
        gc<span class="token punctuation">.</span><span class="token function">setOpen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 是否覆盖</span>
        gc<span class="token punctuation">.</span><span class="token function">setFileOverride</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 去除service的I前缀</span>
        gc<span class="token punctuation">.</span><span class="token function">setServiceName</span><span class="token punctuation">(</span><span class="token string">&quot;%sService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置id策略</span>
        gc<span class="token punctuation">.</span><span class="token function">setIdType</span><span class="token punctuation">(</span><span class="token class-name">IdType</span><span class="token punctuation">.</span>ID_WORKER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置日期类型</span>
        gc<span class="token punctuation">.</span><span class="token function">setDateType</span><span class="token punctuation">(</span><span class="token class-name">DateType</span><span class="token punctuation">.</span>ONLY_DATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc<span class="token punctuation">.</span><span class="token function">setSwagger2</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mpg<span class="token punctuation">.</span><span class="token function">setGlobalConfig</span><span class="token punctuation">(</span>gc<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 设置数据源</span>
        <span class="token class-name">DataSourceConfig</span> dsc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dsc<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dsc<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;1234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dsc<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc:mysql://localhost:3306/mybatis_plus?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dsc<span class="token punctuation">.</span><span class="token function">setDriverName</span><span class="token punctuation">(</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dsc<span class="token punctuation">.</span><span class="token function">setDbType</span><span class="token punctuation">(</span><span class="token class-name">DbType</span><span class="token punctuation">.</span>MYSQL<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mpg<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dsc<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置包</span>
        <span class="token class-name">PackageConfig</span> packageConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PackageConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 模块名</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setModuleName</span><span class="token punctuation">(</span><span class="token string">&quot;blog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 父包名</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span><span class="token string">&quot;com.kuang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setEntity</span><span class="token punctuation">(</span><span class="token string">&quot;entity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setMapper</span><span class="token punctuation">(</span><span class="token string">&quot;dao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setService</span><span class="token punctuation">(</span><span class="token string">&quot;service&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        packageConfig<span class="token punctuation">.</span><span class="token function">setController</span><span class="token punctuation">(</span><span class="token string">&quot;controller&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mpg<span class="token punctuation">.</span><span class="token function">setPackageInfo</span><span class="token punctuation">(</span>packageConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//策略配置</span>
        <span class="token class-name">StrategyConfig</span> strategyConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StrategyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置要映射的表名</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setInclude</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//逻辑删除</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setLogicDeleteFieldName</span><span class="token punctuation">(</span><span class="token string">&quot;deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//驼峰</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>underline_to_camel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setColumnNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>underline_to_camel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//strategyConfig.setSuperEntityClass(&quot;你自己父类的实体，没有不要设置&quot;);</span>
        <span class="token comment">// lombok</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setEntityLombokModel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//自动填充配置</span>
        <span class="token class-name">TableFill</span> create_time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TableFill</span><span class="token punctuation">(</span><span class="token string">&quot;create_time&quot;</span><span class="token punctuation">,</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span>INSERT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TableFill</span> update_time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TableFill</span><span class="token punctuation">(</span><span class="token string">&quot;update_time&quot;</span><span class="token punctuation">,</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span>INSERT_UPDATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setTableFillList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>create_time<span class="token punctuation">,</span> update_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 乐观锁</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setVersionFieldName</span><span class="token punctuation">(</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 开启restful驼峰明明格式</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setRestControllerStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 开启localhost:8080/hello_id_2格式</span>
        strategyConfig<span class="token punctuation">.</span><span class="token function">setControllerMappingHyphenStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mpg<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span>strategyConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mpg<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><p>狂神git仓卡:</p> <p><a href="https://gitee.com/kuangstudy/kuang_livenote?_from=gitee_search" target="_blank" rel="noopener noreferrer">https://gitee.com/kuangstudy/kuang_livenote?_from=gitee_search<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/1/16 下午5:53:08</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/md/java/learn/Mybatis笔记.html" class="prev">
        Mybatis
      </a></span> <span class="next"><a href="/md/java/learn/SpringBoot笔记.html">
        SpringBoot
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7437448f.js" defer></script><script src="/assets/js/5.ea3a467f.js" defer></script><script src="/assets/js/16.de77b749.js" defer></script>
  </body>
</html>
